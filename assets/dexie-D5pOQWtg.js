var Yr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Si(q){return q&&q.__esModule&&Object.prototype.hasOwnProperty.call(q,"default")?q.default:q}var Wr={exports:{}};(function(q,V){(function(N,j){q.exports=j()})(Yr,function(){var N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])})(e,t)},j=function(){return(j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Y(e,t,n){for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||((r=r||Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var C=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Yr,w=Object.keys,H=Array.isArray;function se(e,t){return typeof t!="object"||w(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||C.Promise||(C.Promise=Promise);var T=Object.getPrototypeOf,re={}.hasOwnProperty;function le(e,t){return re.call(e,t)}function Ye(e,t){typeof t=="function"&&(t=t(T(e))),(typeof Reflect>"u"?w:Reflect.ownKeys)(t).forEach(function(n){ve(e,n,t[n])})}var ot=Object.defineProperty;function ve(e,t,n,r){ot(e,t,se(n&&le(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function be(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ve(e.prototype,"constructor",e),{extend:Ye.bind(null,e.prototype)}}}}var Ue=Object.getOwnPropertyDescriptor,mt=[].slice;function Ze(e,t,n){return mt.call(e,t,n)}function oe(e,t){return t(e)}function ct(e){if(!e)throw new Error("Assertion Failed")}function he(e){C.setImmediate?setImmediate(e):setTimeout(e,0)}function Ae(e,t){if(typeof t=="string"&&le(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=Ae(e,t[r]);n.push(a)}return n}var c=t.indexOf(".");if(c!==-1){var f=e[t.substr(0,c)];return f==null?void 0:Ae(f,t.substr(c+1))}}function ge(e,t,n){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ct(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)ge(e,t[r],n[r])}else{var a,c,f=t.indexOf(".");f!==-1?(a=t.substr(0,f),(c=t.substr(f+1))===""?n===void 0?H(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n:ge(f=!(f=e[a])||!le(e,a)?e[a]={}:f,c,n)):n===void 0?H(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function bt(e){var t,n={};for(t in e)le(e,t)&&(n[t]=e[t]);return n}var P=[].concat;function l(e){return P.apply([],e)}var Wt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(l([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return C[e]}),M=new Set(Wt.map(function(e){return C[e]})),B=null;function Oe(e){return B=new WeakMap,e=function t(n){if(!n||typeof n!="object")return n;var r=B.get(n);if(r)return r;if(H(n)){r=[],B.set(n,r);for(var i=0,a=n.length;i<a;++i)r.push(t(n[i]))}else if(M.has(n.constructor))r=n;else{var c,f=T(n);for(c in r=f===Object.prototype?{}:Object.create(f),B.set(n,r),n)le(n,c)&&(r[c]=t(n[c]))}return r}(e),B=null,e}var Se={}.toString;function Fe(e){return Se.call(e).slice(8,-1)}var Ge=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ut=typeof Ge=="symbol"?function(e){var t;return e!=null&&(t=e[Ge])&&t.apply(e)}:function(){return null};function st(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var at={};function je(e){var t,n,r,i;if(arguments.length===1){if(H(e))return e.slice();if(this===at&&typeof e=="string")return[e];if(i=ut(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Qe=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},De=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(De),Tt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function gt(e,t){this.name=e,this.message=t}function me(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function $e(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=me(e,t)}function lt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=me(e,this.failures)}be(gt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),be($e).from(gt),be(lt).from(gt);var K=Mt.reduce(function(e,t){return e[t]=t+"Error",e},{}),F=gt,E=Mt.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Tt[t]||n,this.inner=null)}return be(r).from(F),e[t]=r,e},{});E.Syntax=SyntaxError,E.Type=TypeError,E.Range=RangeError;var U=De.reduce(function(e,t){return e[t+"Error"]=E[t],e},{}),G=Mt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=E[t]),e},{});function ie(){}function Ee(e){return e}function Ie(e,t){return e==null||e===Ee?t:function(n){return t(e(n))}}function ce(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function yt(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ce(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ce(i,this.onerror):i),a!==void 0?a:n}}function xt(e,t){return e===ie?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ce(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ce(r,this.onerror):r)}}function Bt(e,t){return e===ie?t:function(n){var r=e.apply(this,arguments);se(n,r);var i=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?ce(i,this.onsuccess):i),a&&(this.onerror=this.onerror?ce(a,this.onerror):a),r===void 0?n===void 0?void 0:n:se(r,n)}}function Lt(e,t){return e===ie?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Kt(e,t){return e===ie?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}G.ModifyError=$e,G.DexieError=gt,G.BulkError=lt;var dt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function kt(e){dt=e}var Et={},nt=100,Wt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,T(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,T(t),e]}(),De=Wt[0],Mt=Wt[1],Wt=Wt[2],Mt=Mt&&Mt.then,Be=De&&De.constructor,qe=!!Wt,Xe=function(e,t){W.push([e,t]),s&&(queueMicrotask(We),s=!1)},fe=!0,s=!0,o=[],u=[],h=Ee,g={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ie,pgp:!1,env:{},finalize:ie},k=g,W=[],ae=0,ee=[];function D(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=k;if(typeof e!="function"){if(e!==Et)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Le(this,this._value))}this._state=null,this._value=null,++t.ref,function n(r,i){try{i(function(a){if(r._state===null){if(a===r)throw new TypeError("A promise cannot be resolved with itself.");var c=r._lib&&de();a&&typeof a.then=="function"?n(r,function(f,v){a instanceof D?a._then(f,v):a.then(f,v)}):(r._state=!0,r._value=a,Ke(r)),c&&rt()}},Le.bind(null,r))}catch(a){Le(r,a)}}(this,e)}var we={get:function(){var e=k,t=et;function n(r,i){var a=this,c=!e.global&&(e!==k||t!==et),f=c&&!pt(),v=new D(function(d,_){Ce(a,new Te(sn(r,e,c,f),sn(i,e,c,f),d,_,e))});return this._consoleTask&&(v._consoleTask=this._consoleTask),v}return n.prototype=Et,n},set:function(e){ve(this,"then",e&&e.prototype===Et?we:{get:function(){return e},set:we.set})}};function Te(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}function Le(e,t){var n,r;u.push(t),e._state===null&&(n=e._lib&&de(),t=h(t),e._state=!1,e._value=t,r=e,o.some(function(i){return i._value===r._value})||o.push(r),Ke(e),n&&rt())}function Ke(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ce(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),ae===0&&(++ae,Xe(function(){--ae==0&&ue()},[]))}function Ce(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ae,Xe(ze,[n,e,t])}else e._listeners.push(t)}function ze(e,t,n){try{var r,i=t._value;!t._state&&u.length&&(u=[]),r=dt&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||u.indexOf(i)!==-1||function(a){for(var c=o.length;c;)if(o[--c]._value===a._value)return o.splice(c,1)}(t),n.resolve(r)}catch(a){n.reject(a)}finally{--ae==0&&ue(),--n.psd.ref||n.psd.finalize()}}function We(){vt(g,function(){de()&&rt()})}function de(){var e=fe;return s=fe=!1,e}function rt(){var e,t,n;do for(;0<W.length;)for(e=W,W=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<W.length);s=fe=!0}function ue(){var e=o;o=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=ee.slice(0),n=t.length;n;)t[--n]()}function J(e){return new D(Et,!1,e)}function Q(e,t){var n=k;return function(){var r=de(),i=k;try{return it(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{it(i,!1),r&&rt()}}}Ye(D.prototype,{then:we,_then:function(e,t){Ce(this,new Te(null,null,e,t,k))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t=="function"?this.then(null,function(r){return(r instanceof t?n:J)(r)}):this.then(null,function(r){return(r&&r.name===t?n:J)(r)})},finally:function(e){return this.then(function(t){return D.resolve(e()).then(function(){return t})},function(t){return D.resolve(e()).then(function(){return J(t)})})},timeout:function(e,t){var n=this;return e<1/0?new D(function(r,i){var a=setTimeout(function(){return i(new E.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ve(D.prototype,Symbol.toStringTag,"Dexie.Promise"),g.env=Ft(),Ye(D,{all:function(){var e=je.apply(null,arguments).map(Je);return new D(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return D.resolve(i).then(function(c){e[a]=c,--r||t(e)},n)})})},resolve:function(e){return e instanceof D?e:e&&typeof e.then=="function"?new D(function(t,n){e.then(t,n)}):new D(Et,!0,e)},reject:J,race:function(){var e=je.apply(null,arguments).map(Je);return new D(function(t,n){e.map(function(r){return D.resolve(r).then(t,n)})})},PSD:{get:function(){return k},set:function(e){return k=e}},totalEchoes:{get:function(){return et}},newPSD:ft,usePSD:vt,scheduler:{get:function(){return Xe},set:function(e){Xe=e}},rejectionMapper:{get:function(){return h},set:function(e){h=e}},follow:function(e,t){return new D(function(n,r){return ft(function(i,a){var c=k;c.unhandleds=[],c.onunhandled=a,c.finalize=ce(function(){var f,v=this;f=function(){v.unhandleds.length===0?i():a(v.unhandleds[0])},ee.push(function d(){f(),ee.splice(ee.indexOf(d),1)}),++ae,Xe(function(){--ae==0&&ue()},[])},c.finalize),e()},t,n,r)})}}),Be&&(Be.allSettled&&ve(D,"allSettled",function(){var e=je.apply(null,arguments).map(Je);return new D(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return D.resolve(i).then(function(c){return r[a]={status:"fulfilled",value:c}},function(c){return r[a]={status:"rejected",reason:c}}).then(function(){return--n||t(r)})})})}),Be.any&&typeof AggregateError<"u"&&ve(D,"any",function(){var e=je.apply(null,arguments).map(Je);return new D(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,c){return D.resolve(a).then(function(f){return t(f)},function(f){i[c]=f,--r||n(new AggregateError(i))})})})}));var ne={awaits:0,echoes:0,id:0},pe=0,_e=[],wt=0,et=0,Pt=0;function ft(e,t,n,r){var i=k,a=Object.create(i);return a.parent=i,a.ref=0,a.global=!1,a.id=++Pt,g.env,a.env=qe?{Promise:D,PromiseProp:{value:D,configurable:!0,writable:!0},all:D.all,race:D.race,allSettled:D.allSettled,any:D.any,resolve:D.resolve,reject:D.reject}:{},t&&se(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},r=vt(a,e,n,r),a.ref===0&&a.finalize(),r}function Re(){return ne.id||(ne.id=++pe),++ne.awaits,ne.echoes+=nt,ne.id}function pt(){return!!ne.awaits&&(--ne.awaits==0&&(ne.id=0),ne.echoes=ne.awaits*nt,!0)}function Je(e){return ne.echoes&&e&&e.constructor===Be?(Re(),e.then(function(t){return pt(),t},function(t){return pt(),He(t)})):e}function Rt(){var e=_e[_e.length-1];_e.pop(),it(e,!1)}function it(e,t){var n,r=k;(t?!ne.echoes||wt++&&e===k:!wt||--wt&&e===k)||queueMicrotask(t?(function(i){++et,ne.echoes&&--ne.echoes!=0||(ne.echoes=ne.awaits=ne.id=0),_e.push(k),it(i,!0)}).bind(null,e):Rt),e!==k&&(k=e,r===g&&(g.env=Ft()),qe&&(n=g.env.Promise,t=e.env,(r.global||e.global)&&(Object.defineProperty(C,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Ft(){var e=C.Promise;return qe?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(C,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function vt(e,t,n,r,i){var a=k;try{return it(e,!0),t(n,r,i)}finally{it(a,!1)}}function sn(e,t,n,r){return typeof e!="function"?e:function(){var i=k;n&&Re(),it(t,!0);try{return e.apply(this,arguments)}finally{it(i,!1),r&&queueMicrotask(pt)}}}function Qt(e){Promise===Be&&ne.echoes===0?wt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+Mt).indexOf("[native code]")===-1&&(Re=pt=ie);var He=D.reject,$t="ï¿¿",_t="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ot="String expected.",Nt=[],qt="__dbnames",Xt="readonly",Mn="readwrite";function rn(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var _r={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function On(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=Oe(t))[e],t}}function Or(){throw E.Type()}function Ve(e,t){try{var n=Sr(e),r=Sr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(i,a){for(var c=i.length,f=a.length,v=c<f?c:f,d=0;d<v;++d)if(i[d]!==a[d])return i[d]<a[d]?-1:1;return c===f?0:c<f?-1:1}(Er(e),Er(t));case"Array":return function(i,a){for(var c=i.length,f=a.length,v=c<f?c:f,d=0;d<v;++d){var _=Ve(i[d],a[d]);if(_!==0)return _}return c===f?0:c<f?-1:1}(e,t)}}catch{}return NaN}function Sr(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=Fe(e),e==="ArrayBuffer"?"binary":e)}function Er(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ar=(tt.prototype._trans=function(e,t,n){var r=this._tx||k.trans,i=this.name,a=dt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function c(d,_,p){if(!p.schema[i])throw new E.NotFound("Table "+i+" not part of transaction");return t(p.idbtrans,p)}var f=de();try{var v=r&&r.db._novip===this.db._novip?r===k.trans?r._promise(e,c,n):ft(function(){return r._promise(e,c,n)},{trans:r,transless:k.transless||k}):function d(_,p,O,y){if(_.idbdb&&(_._state.openComplete||k.letThrough||_._vip)){var b=_._createTransaction(p,O,_._dbSchema);try{b.create(),_._state.PR1398_maxLoop=3}catch(S){return S.name===K.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return d(_,p,O,y)})):He(S)}return b._promise(p,function(S,m){return ft(function(){return k.trans=b,y(S,m,b)})}).then(function(S){if(p==="readwrite")try{b.idbtrans.commit()}catch{}return p==="readonly"?S:b._completion.then(function(){return S})})}if(_._state.openComplete)return He(new E.DatabaseClosed(_._state.dbOpenError));if(!_._state.isBeingOpened){if(!_._state.autoOpen)return He(new E.DatabaseClosed);_.open().catch(ie)}return _._state.dbReadyPromise.then(function(){return d(_,p,O,y)})}(this.db,e,[this.name],c);return a&&(v._consoleTask=a,v=v.catch(function(d){return console.trace(d),He(d)})),v}finally{f&&rt()}},tt.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?He(new E.Type("Invalid argument to Table.get()")):this._trans("readonly",function(r){return n.core.get({trans:r,key:e}).then(function(i){return n.hook.reading.fire(i)})}).then(t)},tt.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(H(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=w(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&t.every(function(_){return 0<=v.keyPath.indexOf(_)})){for(var d=0;d<t.length;++d)if(t.indexOf(v.keyPath[d])===-1)return!1;return!0}return!1}).sort(function(v,d){return v.keyPath.length-d.keyPath.length})[0];if(n&&this.db._maxKey!==$t){var c=n.keyPath.slice(0,t.length);return this.where(c).equals(c.map(function(d){return e[d]}))}!n&&dt&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName,i=this.db._deps.indexedDB;function a(v,d){return i.cmp(v,d)===0}var f=t.reduce(function(O,d){var _=O[0],p=O[1],O=r[d],y=e[d];return[_||O,_||!O?rn(p,O&&O.multi?function(b){return b=Ae(b,d),H(b)&&b.some(function(S){return a(y,S)})}:function(b){return a(y,Ae(b,d))}):p]},[null,null]),c=f[0],f=f[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(f):n?this.filter(f):this.where(t).equals("")},tt.prototype.filter=function(e){return this.toCollection().and(e)},tt.prototype.count=function(e){return this.toCollection().count(e)},tt.prototype.offset=function(e){return this.toCollection().offset(e)},tt.prototype.limit=function(e){return this.toCollection().limit(e)},tt.prototype.each=function(e){return this.toCollection().each(e)},tt.prototype.toArray=function(e){return this.toCollection().toArray(e)},tt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},tt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,H(e)?"[".concat(e.join("+"),"]"):e))},tt.prototype.reverse=function(){return this.toCollection().reverse()},tt.prototype.mapToClass=function(e){var t,n=this.db,r=this.name;function i(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof Or&&(function(v,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");function _(){this.constructor=v}N(v,d),v.prototype=d===null?Object.create(d):(_.prototype=d.prototype,new _)}(i,t=e),Object.defineProperty(i.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),i.prototype.table=function(){return r},e=i);for(var a=new Set,c=e.prototype;c;c=T(c))Object.getOwnPropertyNames(c).forEach(function(v){return a.add(v)});function f(v){if(!v)return v;var d,_=Object.create(e.prototype);for(d in v)if(!a.has(d))try{_[d]=v[d]}catch{}return _}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=f,this.hook("reading",f),e},tt.prototype.defineClass=function(){return this.mapToClass(function(e){se(this,e)})},tt.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=On(a)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"add",keys:t!=null?[t]:null,values:[c]})}).then(function(f){return f.numFailures?D.reject(f.failures[0]):f.lastResult}).then(function(f){if(a)try{ge(e,a,f)}catch{}return f})},tt.prototype.update=function(e,t){return typeof e!="object"||H(e)?this.where(":id").equals(e).modify(t):(e=Ae(e,this.schema.primKey.keyPath),e===void 0?He(new E.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},tt.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,c=e;return a&&i&&(c=On(a)(e)),this._trans("readwrite",function(f){return n.core.mutate({trans:f,type:"put",values:[c],keys:t!=null?[t]:null})}).then(function(f){return f.numFailures?D.reject(f.failures[0]):f.lastResult}).then(function(f){if(a)try{ge(e,a,f)}catch{}return f})},tt.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})}).then(function(n){return n.numFailures?D.reject(n.failures[0]):void 0})},tt.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:_r})}).then(function(t){return t.numFailures?D.reject(t.failures[0]):void 0})},tt.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(r){return r.map(function(i){return t.hook.reading.fire(i)})})})},tt.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var d=r.schema.primKey,f=d.auto,d=d.keyPath;if(d&&i)throw new E.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,d=d&&f?e.map(On(d)):e;return r.core.mutate({trans:c,type:"add",keys:i,values:d,wantResults:a}).then(function(b){var p=b.numFailures,O=b.results,y=b.lastResult,b=b.failures;if(p===0)return a?O:y;throw new lt("".concat(r.name,".bulkAdd(): ").concat(p," of ").concat(v," operations failed"),b)})})},tt.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(c){var d=r.schema.primKey,f=d.auto,d=d.keyPath;if(d&&i)throw new E.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new E.InvalidArgument("Arguments objects and keys must have the same length");var v=e.length,d=d&&f?e.map(On(d)):e;return r.core.mutate({trans:c,type:"put",keys:i,values:d,wantResults:a}).then(function(b){var p=b.numFailures,O=b.results,y=b.lastResult,b=b.failures;if(p===0)return a?O:y;throw new lt("".concat(r.name,".bulkPut(): ").concat(p," of ").concat(v," operations failed"),b)})})},tt.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(c){return c.key}),i=e.map(function(c){return c.changes}),a=[];return this._trans("readwrite",function(c){return n.getMany({trans:c,keys:r,cache:"clone"}).then(function(f){var v=[],d=[];e.forEach(function(p,O){var y=p.key,b=p.changes,S=f[O];if(S){for(var m=0,A=Object.keys(b);m<A.length;m++){var x=A[m],I=b[x];if(x===t.schema.primKey.keyPath){if(Ve(I,y)!==0)throw new E.Constraint("Cannot update primary key in bulkUpdate()")}else ge(S,x,I)}a.push(O),v.push(y),d.push(S)}});var _=v.length;return n.mutate({trans:c,type:"put",keys:v,values:d,updates:{keys:r,changeSpecs:i}}).then(function(p){var O=p.numFailures,y=p.failures;if(O===0)return _;for(var b=0,S=Object.keys(y);b<S.length;b++){var m,A=S[b],x=a[Number(A)];x!=null&&(m=y[A],delete y[A],y[x]=m)}throw new lt("".concat(t.name,".bulkUpdate(): ").concat(O," of ").concat(_," operations failed"),y)})})})},tt.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:e})}).then(function(c){var i=c.numFailures,a=c.lastResult,c=c.failures;if(i===0)return a;throw new lt("".concat(t.name,".bulkDelete(): ").concat(i," of ").concat(n," operations failed"),c)})},tt);function tt(){}function hn(e){function t(c,f){if(f){for(var v=arguments.length,d=new Array(v-1);--v;)d[v-1]=arguments[v];return n[c].subscribe.apply(null,d),e}if(typeof c=="string")return n[c]}var n={};t.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return t;function a(c,f,v){if(typeof c!="object"){var d;f=f||Lt;var _={subscribers:[],fire:v=v||ie,subscribe:function(p){_.subscribers.indexOf(p)===-1&&(_.subscribers.push(p),_.fire=f(_.fire,p))},unsubscribe:function(p){_.subscribers=_.subscribers.filter(function(O){return O!==p}),_.fire=_.subscribers.reduce(f,v)}};return n[c]=t[c]=_}w(d=c).forEach(function(p){var O=d[p];if(H(O))a(p,d[p][0],d[p][1]);else{if(O!=="asap")throw new E.InvalidArgument("Invalid event config");var y=a(p,Ee,function(){for(var b=arguments.length,S=new Array(b);b--;)S[b]=arguments[b];y.subscribers.forEach(function(m){he(function(){m.apply(null,S)})})})}})}}function dn(e,t){return be(t).from({prototype:e}),t}function cn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Vn(e,t){e.filter=rn(e.filter,t)}function $n(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return rn(r(),t())}:t,e.justLimit=n&&!r}function Sn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new E.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Tr(e,t,n){var r=Sn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function En(e,t,n,r){var i=e.replayFilter?rn(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},c=function(f,v,d){var _,p;i&&!i(v,d,function(O){return v.stop(O)},function(O){return v.fail(O)})||((p=""+(_=v.primaryKey))=="[object ArrayBuffer]"&&(p=""+new Uint8Array(_)),le(a,p)||(a[p]=!0,t(f,v,d)))};return Promise.all([e.or._iterate(c,n),xr(Tr(e,r,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return xr(Tr(e,r,n),rn(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function xr(e,t,n,r){var i=Q(r?function(a,c,f){return n(r(a),c,f)}:n);return e.then(function(a){if(a)return a.start(function(){var c=function(){return a.continue()};t&&!t(a,function(f){return c=f},function(f){a.stop(f),c=ie},function(f){a.fail(f),c=ie})||i(a.value,a,function(f){return c=f}),c()})})}var Wt=Symbol(),Jn=(kr.prototype.execute=function(e){var t=(t=this.replacePrefix)===null||t===void 0?void 0:t[0];return t&&typeof e=="string"&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},kr);function kr(e){Object.assign(this,e)}var ri=(Me.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,He.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Me.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,He.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Me.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=rn(t.algorithm,e)},Me.prototype._iterate=function(e,t){return En(this._ctx,e,t,this._ctx.table.core)},Me.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&se(n,e),t._ctx=n,t},Me.prototype.raw=function(){return this._ctx.valueMapper=null,this},Me.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return En(t,e,n,t.table.core)})},Me.prototype.count=function(e){var t=this;return this._read(function(n){var r=t._ctx,i=r.table.core;if(cn(r,!0))return i.count({trans:n,query:{index:Sn(r,i.schema),range:r.range}}).then(function(c){return Math.min(c,r.limit)});var a=0;return En(r,function(){return++a,!1},n,i).then(function(){return a})}).then(e)},Me.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function a(v,d){return d?a(v[n[d]],d-1):v[r]}var c=this._ctx.dir==="next"?1:-1;function f(v,d){return v=a(v,i),d=a(d,i),v<d?-c:d<v?c:0}return this.toArray(function(v){return v.sort(f)}).then(t)},Me.prototype.toArray=function(e){var t=this;return this._read(function(n){var r=t._ctx;if(r.dir==="next"&&cn(r,!0)&&0<r.limit){var i=r.valueMapper,a=Sn(r,r.table.core.schema);return r.table.core.query({trans:n,limit:r.limit,values:!0,query:{index:a,range:r.range}}).then(function(f){return f=f.result,i?f.map(i):f})}var c=[];return En(r,function(f){return c.push(f)},n,r.table.core).then(function(){return c})},e)},Me.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,cn(t)?$n(t,function(){var n=e;return function(r,i){return n===0||(n===1?--n:i(function(){r.advance(n),n=0}),!1)}}):$n(t,function(){var n=e;return function(){return--n<0}})),this},Me.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),$n(this._ctx,function(){var t=e;return function(n,r,i){return--t<=0&&r(i),0<=t}},!0),this},Me.prototype.until=function(e,t){return Vn(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},Me.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},Me.prototype.last=function(e){return this.reverse().first(e)},Me.prototype.filter=function(e){var t;return Vn(this._ctx,function(n){return e(n.value)}),(t=this._ctx).isMatch=rn(t.isMatch,e),this},Me.prototype.and=function(e){return this.filter(e)},Me.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Me.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Me.prototype.desc=function(){return this.reverse()},Me.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.key,r)})},Me.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Me.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(n,r){e(r.primaryKey,r)})},Me.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.key)}).then(function(){return n}).then(e)},Me.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&cn(t,!0)&&0<t.limit)return this._read(function(r){var i=Sn(t,t.table.core.schema);return t.table.core.query({trans:r,values:!1,limit:t.limit,query:{index:i,range:t.range}})}).then(function(r){return r.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(r,i){n.push(i.primaryKey)}).then(function(){return n}).then(e)},Me.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Me.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},Me.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Me.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Vn(this._ctx,function(i){var r=i.primaryKey.toString(),i=le(t,r);return t[r]=!0,!i}),this},Me.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i,a,c;c=typeof e=="function"?e:(i=w(e),a=i.length,function(m){for(var A=!1,x=0;x<a;++x){var I=i[x],R=e[I],L=Ae(m,I);R instanceof Jn?(ge(m,I,R.execute(L)),A=!0):L!==R&&(ge(m,I,R),A=!0)}return A});function f(m,I){var x=I.failures,I=I.numFailures;b+=m-I;for(var R=0,L=w(x);R<L.length;R++){var X=L[R];y.push(x[X])}}var v=n.table.core,d=v.schema.primaryKey,_=d.outbound,p=d.extractKey,O=t.db._options.modifyChunkSize||200,y=[],b=0,S=[];return t.clone().primaryKeys().then(function(m){function A(x){var I=Math.min(O,m.length-x);return v.getMany({trans:r,keys:m.slice(x,x+I),cache:"immutable"}).then(function(R){for(var L=[],X=[],$=_?[]:null,z=[],Z=0;Z<I;++Z){var te=R[Z],ye={value:Oe(te),primKey:m[x+Z]};c.call(ye,ye.value,ye)!==!1&&(ye.value==null?z.push(m[x+Z]):_||Ve(p(te),p(ye.value))===0?(X.push(ye.value),_&&$.push(m[x+Z])):(z.push(m[x+Z]),L.push(ye.value)))}var xe=cn(n)&&n.limit===1/0&&(typeof e!="function"||e===Yn)&&{index:n.index,range:n.range};return Promise.resolve(0<L.length&&v.mutate({trans:r,type:"add",values:L}).then(function(Ne){for(var ke in Ne.failures)z.splice(parseInt(ke),1);f(L.length,Ne)})).then(function(){return(0<X.length||xe&&typeof e=="object")&&v.mutate({trans:r,type:"put",keys:$,values:X,criteria:xe,changeSpec:typeof e!="function"&&e}).then(function(Ne){return f(X.length,Ne)})}).then(function(){return(0<z.length||xe&&e===Yn)&&v.mutate({trans:r,type:"delete",keys:z,criteria:xe}).then(function(Ne){return f(z.length,Ne)})}).then(function(){return m.length>x+I&&A(x+O)})})}return A(0).then(function(){if(0<y.length)throw new $e("Error modifying one or more objects",y,b,S);return m.length})})})},Me.prototype.delete=function(){var e=this._ctx,t=e.range;return cn(e)&&(e.isPrimKey||t.type===3)?this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(a){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(c){var f=c.failures;if(c.lastResult,c.results,c=c.numFailures,c)throw new $e("Could not delete some values",Object.keys(f).map(function(v){return f[v]}),a-c);return a-c})})}):this.modify(Yn)},Me);function Me(){}var Yn=function(e,t){return t.value=null};function ii(e,t){return e<t?-1:e===t?0:1}function oi(e,t){return t<e?-1:e===t?0:1}function Ut(e,t,n){return e=e instanceof Nr?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function ln(e){return new e.Collection(e,function(){return Pr("")}).limit(0)}function An(e,t,n,r){var i,a,c,f,v,d,_,p=n.length;if(!n.every(function(b){return typeof b=="string"}))return Ut(e,Ot);function O(b){i=b==="next"?function(m){return m.toUpperCase()}:function(m){return m.toLowerCase()},a=b==="next"?function(m){return m.toLowerCase()}:function(m){return m.toUpperCase()},c=b==="next"?ii:oi;var S=n.map(function(m){return{lower:a(m),upper:i(m)}}).sort(function(m,A){return c(m.lower,A.lower)});f=S.map(function(m){return m.upper}),v=S.map(function(m){return m.lower}),_=(d=b)==="next"?"":r}O("next"),e=new e.Collection(e,function(){return Zt(f[0],v[p-1]+r)}),e._ondirectionchange=function(b){O(b)};var y=0;return e._addAlgorithm(function(b,S,m){var A=b.key;if(typeof A!="string")return!1;var x=a(A);if(t(x,v,y))return!0;for(var I=null,R=y;R<p;++R){var L=function(X,$,z,Z,te,ye){for(var xe=Math.min(X.length,Z.length),Ne=-1,ke=0;ke<xe;++ke){var Jt=$[ke];if(Jt!==Z[ke])return te(X[ke],z[ke])<0?X.substr(0,ke)+z[ke]+z.substr(ke+1):te(X[ke],Z[ke])<0?X.substr(0,ke)+Z[ke]+z.substr(ke+1):0<=Ne?X.substr(0,Ne)+$[Ne]+z.substr(Ne+1):null;te(X[ke],Jt)<0&&(Ne=ke)}return xe<Z.length&&ye==="next"?X+z.substr(X.length):xe<X.length&&ye==="prev"?X.substr(0,z.length):Ne<0?null:X.substr(0,Ne)+Z[Ne]+z.substr(Ne+1)}(A,x,f[R],v[R],c,d);L===null&&I===null?y=R+1:(I===null||0<c(I,L))&&(I=L)}return S(I!==null?function(){b.continue(I+_)}:m),!1}),e}function Zt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Pr(e){return{type:1,lower:e,upper:e}}var Nr=(Object.defineProperty(St.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),St.prototype.between=function(e,t,n,r){n=n!==!1,r=r===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?ln(this):new this.Collection(this,function(){return Zt(e,t,!n,!r)})}catch{return Ut(this,_t)}},St.prototype.equals=function(e){return e==null?Ut(this,_t):new this.Collection(this,function(){return Pr(e)})},St.prototype.above=function(e){return e==null?Ut(this,_t):new this.Collection(this,function(){return Zt(e,void 0,!0)})},St.prototype.aboveOrEqual=function(e){return e==null?Ut(this,_t):new this.Collection(this,function(){return Zt(e,void 0,!1)})},St.prototype.below=function(e){return e==null?Ut(this,_t):new this.Collection(this,function(){return Zt(void 0,e,!1,!0)})},St.prototype.belowOrEqual=function(e){return e==null?Ut(this,_t):new this.Collection(this,function(){return Zt(void 0,e)})},St.prototype.startsWith=function(e){return typeof e!="string"?Ut(this,Ot):this.between(e,e+$t,!0,!0)},St.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):An(this,function(t,n){return t.indexOf(n[0])===0},[e],$t)},St.prototype.equalsIgnoreCase=function(e){return An(this,function(t,n){return t===n[0]},[e],"")},St.prototype.anyOfIgnoreCase=function(){var e=je.apply(at,arguments);return e.length===0?ln(this):An(this,function(t,n){return n.indexOf(t)!==-1},e,"")},St.prototype.startsWithAnyOfIgnoreCase=function(){var e=je.apply(at,arguments);return e.length===0?ln(this):An(this,function(t,n){return n.some(function(r){return t.indexOf(r)===0})},e,$t)},St.prototype.anyOf=function(){var e=this,t=je.apply(at,arguments),n=this._cmp;try{t.sort(n)}catch{return Ut(this,_t)}if(t.length===0)return ln(this);var r=new this.Collection(this,function(){return Zt(t[0],t[t.length-1])});r._ondirectionchange=function(a){n=a==="next"?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(a,c,f){for(var v=a.key;0<n(v,t[i]);)if(++i===t.length)return c(f),!1;return n(v,t[i])===0||(c(function(){a.continue(t[i])}),!1)}),r},St.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},St.prototype.noneOf=function(){var e=je.apply(at,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ut(this,_t)}var t=e.reduce(function(n,r){return n?n.concat([[n[n.length-1][1],r]]):[[-1/0,r]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},St.prototype.inAnyRange=function(A,t){var n=this,r=this._cmp,i=this._ascending,a=this._descending,c=this._min,f=this._max;if(A.length===0)return ln(this);if(!A.every(function(x){return x[0]!==void 0&&x[1]!==void 0&&i(x[0],x[1])<=0}))return Ut(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",E.InvalidArgument);var v=!t||t.includeLowers!==!1,d=t&&t.includeUppers===!0,_,p=i;function O(x,I){return p(x[0],I[0])}try{(_=A.reduce(function(x,I){for(var R=0,L=x.length;R<L;++R){var X=x[R];if(r(I[0],X[1])<0&&0<r(I[1],X[0])){X[0]=c(X[0],I[0]),X[1]=f(X[1],I[1]);break}}return R===L&&x.push(I),x},[])).sort(O)}catch{return Ut(this,_t)}var y=0,b=d?function(x){return 0<i(x,_[y][1])}:function(x){return 0<=i(x,_[y][1])},S=v?function(x){return 0<a(x,_[y][0])}:function(x){return 0<=a(x,_[y][0])},m=b,A=new this.Collection(this,function(){return Zt(_[0][0],_[_.length-1][1],!v,!d)});return A._ondirectionchange=function(x){p=x==="next"?(m=b,i):(m=S,a),_.sort(O)},A._addAlgorithm(function(x,I,R){for(var L,X=x.key;m(X);)if(++y===_.length)return I(R),!1;return!b(L=X)&&!S(L)||(n._cmp(X,_[y][1])===0||n._cmp(X,_[y][0])===0||I(function(){p===i?x.continue(_[y][0]):x.continue(_[y][1])}),!1)}),A},St.prototype.startsWithAnyOf=function(){var e=je.apply(at,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?ln(this):this.inAnyRange(e.map(function(t){return[t,t+$t]})):Ut(this,"startsWithAnyOf() only works with strings")},St);function St(){}function Gt(e){return Q(function(t){return yn(t),e(t.target.error),!1})}function yn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var vn="storagemutated",Gn="x-storagemutated-1",en=hn(null,vn),ai=(zt.prototype._lock=function(){return ct(!k.global),++this._reculock,this._reculock!==1||k.global||(k.lockOwnerFor=this),this},zt.prototype._unlock=function(){if(ct(!k.global),--this._reculock==0)for(k.global||(k.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{vt(e[1],e[0])}catch{}}return this},zt.prototype._locked=function(){return this._reculock&&k.lockOwnerFor!==this},zt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(ct(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new E.DatabaseClosed(r);case"MissingAPIError":throw new E.MissingAPI(r.message,r);default:throw new E.OpenFailed(r)}if(!this.active)throw new E.TransactionInactive;return ct(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Q(function(i){yn(i),t._reject(e.error)}),e.onabort=Q(function(i){yn(i),t.active&&t._reject(new E.Abort(e.error)),t.active=!1,t.on("abort").fire(i)}),e.oncomplete=Q(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&en.storagemutated.fire(e.mutatedParts)}),this},zt.prototype._promise=function(e,t,n){var r=this;if(e==="readwrite"&&this.mode!=="readwrite")return He(new E.ReadOnly("Transaction is readonly"));if(!this.active)return He(new E.TransactionInactive);if(this._locked())return new D(function(a,c){r._blockedFuncs.push([function(){r._promise(e,t,n).then(a,c)},k])});if(n)return ft(function(){var a=new D(function(c,f){r._lock();var v=t(c,f,r);v&&v.then&&v.then(c,f)});return a.finally(function(){return r._unlock()}),a._lib=!0,a});var i=new D(function(a,c){var f=t(a,c,r);f&&f.then&&f.then(a,c)});return i._lib=!0,i},zt.prototype._root=function(){return this.parent?this.parent._root():this},zt.prototype.waitFor=function(e){var t,n=this._root(),r=D.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=a)}());var i=n._waitingFor;return new D(function(a,c){r.then(function(f){return n._waitingQueue.push(Q(a.bind(null,f)))},function(f){return n._waitingQueue.push(Q(c.bind(null,f)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},zt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new E.Abort))},zt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(le(t,e))return t[e];var n=this.schema[e];if(!n)throw new E.NotFound("Table "+e+" not part of transaction");return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},zt);function zt(){}function zn(e,t,n,r,i,a,c){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!c?"&":"")+(r?"*":"")+(i?"++":"")+jr(t)}}function jr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Wn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(i){return[i.name,i]},n.reduce(function(i,a,c){return c=r(a,c),c&&(i[c[0]]=c[1]),i},{}))};var r}var mn=function(e){try{return e.only([[]]),mn=function(){return[[]]},[[]]}catch{return mn=function(){return $t},$t}};function Hn(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(n){return n[t]}:function(n){return Ae(n,t)}:function(n){return Ae(n,e)};var t}function Cr(e){return[].slice.call(e)}var ui=0;function bn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function si(e,t,v){function r(m){if(m.type===3)return null;if(m.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var y=m.lower,b=m.upper,S=m.lowerOpen,m=m.upperOpen;return y===void 0?b===void 0?null:t.upperBound(b,!!m):b===void 0?t.lowerBound(y,!!S):t.bound(y,b,!!S,!!m)}function i(O){var y,b=O.name;return{name:b,schema:O,mutate:function(S){var m=S.trans,A=S.type,x=S.keys,I=S.values,R=S.range;return new Promise(function(L,X){L=Q(L);var $=m.objectStore(b),z=$.keyPath==null,Z=A==="put"||A==="add";if(!Z&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var te,ye=(x||I||{length:1}).length;if(x&&I&&x.length!==I.length)throw new Error("Given keys array must have same length as given values array.");if(ye===0)return L({numFailures:0,failures:{},results:[],lastResult:void 0});function xe(Dt){++Jt,yn(Dt)}var Ne=[],ke=[],Jt=0;if(A==="deleteRange"){if(R.type===4)return L({numFailures:Jt,failures:ke,results:[],lastResult:void 0});R.type===3?Ne.push(te=$.clear()):Ne.push(te=$.delete(r(R)))}else{var z=Z?z?[I,x]:[I,null]:[x,null],Pe=z[0],Ct=z[1];if(Z)for(var It=0;It<ye;++It)Ne.push(te=Ct&&Ct[It]!==void 0?$[A](Pe[It],Ct[It]):$[A](Pe[It])),te.onerror=xe;else for(It=0;It<ye;++It)Ne.push(te=$[A](Pe[It])),te.onerror=xe}function Fn(Dt){Dt=Dt.target.result,Ne.forEach(function(un,yr){return un.error!=null&&(ke[yr]=un.error)}),L({numFailures:Jt,failures:ke,results:A==="delete"?x:Ne.map(function(un){return un.result}),lastResult:Dt})}te.onerror=function(Dt){xe(Dt),Fn(Dt)},te.onsuccess=Fn})},getMany:function(S){var m=S.trans,A=S.keys;return new Promise(function(x,I){x=Q(x);for(var R,L=m.objectStore(b),X=A.length,$=new Array(X),z=0,Z=0,te=function(Ne){Ne=Ne.target,$[Ne._pos]=Ne.result,++Z===z&&x($)},ye=Gt(I),xe=0;xe<X;++xe)A[xe]!=null&&((R=L.get(A[xe]))._pos=xe,R.onsuccess=te,R.onerror=ye,++z);z===0&&x($)})},get:function(S){var m=S.trans,A=S.key;return new Promise(function(x,I){x=Q(x);var R=m.objectStore(b).get(A);R.onsuccess=function(L){return x(L.target.result)},R.onerror=Gt(I)})},query:(y=d,function(S){return new Promise(function(m,A){m=Q(m);var x,I,R,z=S.trans,L=S.values,X=S.limit,te=S.query,$=X===1/0?void 0:X,Z=te.index,te=te.range,z=z.objectStore(b),Z=Z.isPrimaryKey?z:z.index(Z.name),te=r(te);if(X===0)return m({result:[]});y?(($=L?Z.getAll(te,$):Z.getAllKeys(te,$)).onsuccess=function(ye){return m({result:ye.target.result})},$.onerror=Gt(A)):(x=0,I=!L&&"openKeyCursor"in Z?Z.openKeyCursor(te):Z.openCursor(te),R=[],I.onsuccess=function(ye){var xe=I.result;return xe?(R.push(L?xe.value:xe.primaryKey),++x===X?m({result:R}):void xe.continue()):m({result:R})},I.onerror=Gt(A))})}),openCursor:function(S){var m=S.trans,A=S.values,x=S.query,I=S.reverse,R=S.unique;return new Promise(function(L,X){L=Q(L);var Z=x.index,$=x.range,z=m.objectStore(b),z=Z.isPrimaryKey?z:z.index(Z.name),Z=I?R?"prevunique":"prev":R?"nextunique":"next",te=!A&&"openKeyCursor"in z?z.openKeyCursor(r($),Z):z.openCursor(r($),Z);te.onerror=Gt(X),te.onsuccess=Q(function(ye){var xe,Ne,ke,Jt,Pe=te.result;Pe?(Pe.___id=++ui,Pe.done=!1,xe=Pe.continue.bind(Pe),Ne=(Ne=Pe.continuePrimaryKey)&&Ne.bind(Pe),ke=Pe.advance.bind(Pe),Jt=function(){throw new Error("Cursor not stopped")},Pe.trans=m,Pe.stop=Pe.continue=Pe.continuePrimaryKey=Pe.advance=function(){throw new Error("Cursor not started")},Pe.fail=Q(X),Pe.next=function(){var Ct=this,It=1;return this.start(function(){return It--?Ct.continue():Ct.stop()}).then(function(){return Ct})},Pe.start=function(Ct){function It(){if(te.result)try{Ct()}catch(Dt){Pe.fail(Dt)}else Pe.done=!0,Pe.start=function(){throw new Error("Cursor behind last entry")},Pe.stop()}var Fn=new Promise(function(Dt,un){Dt=Q(Dt),te.onerror=Gt(un),Pe.fail=un,Pe.stop=function(yr){Pe.stop=Pe.continue=Pe.continuePrimaryKey=Pe.advance=Jt,Dt(yr)}});return te.onsuccess=Q(function(Dt){te.onsuccess=It,It()}),Pe.continue=xe,Pe.continuePrimaryKey=Ne,Pe.advance=ke,It(),Fn},L(Pe)):L(null)},X)})},count:function(S){var m=S.query,A=S.trans,x=m.index,I=m.range;return new Promise(function(R,L){var X=A.objectStore(b),$=x.isPrimaryKey?X:X.index(x.name),X=r(I),$=X?$.count(X):$.count();$.onsuccess=Q(function(z){return R(z.target.result)}),$.onerror=Gt(L)})}}}var a,c,f,_=(c=v,f=Cr((a=e).objectStoreNames),{schema:{name:a.name,tables:f.map(function(O){return c.objectStore(O)}).map(function(O){var y=O.keyPath,m=O.autoIncrement,b=H(y),S={},m={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y==null,compound:b,keyPath:y,autoIncrement:m,unique:!0,extractKey:Hn(y)},indexes:Cr(O.indexNames).map(function(A){return O.index(A)}).map(function(R){var x=R.name,I=R.unique,L=R.multiEntry,R=R.keyPath,L={name:x,compound:H(R),keyPath:R,unique:I,multiEntry:L,extractKey:Hn(R)};return S[bn(R)]=L}),getIndexByKeyPath:function(A){return S[bn(A)]}};return S[":id"]=m.primaryKey,y!=null&&(S[bn(y)]=m.primaryKey),m})},hasGetAll:0<f.length&&"getAll"in c.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),v=_.schema,d=_.hasGetAll,_=v.tables.map(i),p={};return _.forEach(function(O){return p[O.name]=O}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(O){if(!p[O])throw new Error("Table '".concat(O,"' not found"));return p[O]},MIN_KEY:-1/0,MAX_KEY:mn(t),schema:v}}function ci(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:(r=si(t,i,r),e.dbcore.reduce(function(a,c){return c=c.create,j(j({},a),c(a))},r))}}function Tn(e,r){var n=r.db,r=ci(e._middlewares,n,e._deps,r);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(c){return c.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function xn(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(c){var f=function v(d,_){return Ue(d,_)||(d=T(d))&&v(d,_)}(c,i);(!f||"value"in f&&f.value===void 0)&&(c===e.Transaction.prototype||c instanceof e.Transaction?ve(c,i,{get:function(){return this.table(i)},set:function(v){ot(this,i,{value:v,writable:!0,configurable:!0,enumerable:!0})}}):c[i]=new e.Table(i,a))})})}function Qn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function li(e,t){return e._cfg.version-t._cfg.version}function fi(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Wn("$meta",Br("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var c=a._reject.bind(a),f=k.transless||k;ft(function(){return k.trans=a,k.transless=f,t!==0?(Tn(e,n),d=t,((v=a).storeNames.includes("$meta")?v.table("$meta").get("version").then(function(_){return _??d}):D.resolve(d)).then(function(_){return O=_,y=a,b=n,S=[],_=(p=e)._versions,m=p._dbSchema=Pn(0,p.idbdb,b),(_=_.filter(function(A){return A._cfg.version>=O})).length!==0?(_.forEach(function(A){S.push(function(){var x=m,I=A._cfg.dbschema;Nn(p,x,b),Nn(p,I,b),m=p._dbSchema=I;var R=Xn(x,I);R.add.forEach(function(Z){Zn(b,Z[0],Z[1].primKey,Z[1].indexes)}),R.change.forEach(function(Z){if(Z.recreate)throw new E.Upgrade("Not yet support for changing primary key");var te=b.objectStore(Z.name);Z.add.forEach(function(ye){return kn(te,ye)}),Z.change.forEach(function(ye){te.deleteIndex(ye.name),kn(te,ye)}),Z.del.forEach(function(ye){return te.deleteIndex(ye)})});var L=A._cfg.contentUpgrade;if(L&&A._cfg.version>O){Tn(p,b),y._memoizedTables={};var X=bt(I);R.del.forEach(function(Z){X[Z]=x[Z]}),Qn(p,[p.Transaction.prototype]),xn(p,[p.Transaction.prototype],w(X),X),y.schema=X;var $,z=Qe(L);return z&&Re(),R=D.follow(function(){var Z;($=L(y))&&z&&(Z=pt.bind(null,null),$.then(Z,Z))}),$&&typeof $.then=="function"?D.resolve($):R.then(function(){return $})}}),S.push(function(x){var I,R,L=A._cfg.dbschema;I=L,R=x,[].slice.call(R.db.objectStoreNames).forEach(function(X){return I[X]==null&&R.db.deleteObjectStore(X)}),Qn(p,[p.Transaction.prototype]),xn(p,[p.Transaction.prototype],p._storeNames,p._dbSchema),y.schema=p._dbSchema}),S.push(function(x){p.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(p.idbdb.version/10)===A._cfg.version?(p.idbdb.deleteObjectStore("$meta"),delete p._dbSchema.$meta,p._storeNames=p._storeNames.filter(function(I){return I!=="$meta"})):x.objectStore("$meta").put(A._cfg.version,"version"))})}),function A(){return S.length?D.resolve(S.shift()(y.idbtrans)).then(A):D.resolve()}().then(function(){Ir(m,b)})):D.resolve();var p,O,y,b,S,m}).catch(c)):(w(i).forEach(function(_){Zn(n,_,i[_].primKey,i[_].indexes)}),Tn(e,n),void D.follow(function(){return e.on.populate.fire(a)}).catch(c));var v,d})}function pi(e,t){Ir(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Pn(0,e.idbdb,t);Nn(e,e._dbSchema,t);for(var r=0,i=Xn(n,e._dbSchema).change;r<i.length;r++){var a=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var f=t.objectStore(c.name);c.add.forEach(function(v){dt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(v.src)),kn(f,v)})}(i[r]);if(typeof a=="object")return a.value}}function Xn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],a=t[n];if(i){var c={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)c.recreate=!0,r.change.push(c);else{var f=i.idxByName,v=a.idxByName,d=void 0;for(d in f)v[d]||c.del.push(d);for(d in v){var _=f[d],p=v[d];_?_.src!==p.src&&c.change.push(p):c.add.push(p)}(0<c.del.length||0<c.add.length||0<c.change.length)&&r.change.push(c)}}else r.add.push([n,a])}return r}function Zn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return kn(i,a)}),i}function Ir(e,t){w(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(dt&&console.debug("Dexie: Creating missing table",n),Zn(t,n,e[n].primKey,e[n].indexes))})}function kn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Pn(e,t,n){var r={};return Ze(t.objectStoreNames,0).forEach(function(i){for(var a=n.objectStore(i),c=zn(jr(d=a.keyPath),d||"",!0,!1,!!a.autoIncrement,d&&typeof d!="string",!0),f=[],v=0;v<a.indexNames.length;++v){var _=a.index(a.indexNames[v]),d=_.keyPath,_=zn(_.name,d,!!_.unique,!!_.multiEntry,!1,d&&typeof d!="string",!1);f.push(_)}r[i]=Wn(i,c,f)}),r}function Nn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],c=n.objectStore(a);e._hasGetAll="getAll"in c;for(var f=0;f<c.indexNames.length;++f){var v=c.indexNames[f],d=c.index(v).keyPath,_=typeof d=="string"?d:"["+Ze(d).join("+")+"]";!t[a]||(d=t[a].idxByName[_])&&(d.name=v,delete t[a].idxByName[_],t[a].idxByName[v]=d)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&C.WorkerGlobalScope&&C instanceof C.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Br(e){return e.split(",").map(function(t,n){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return zn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),H(i),n===0)})}var hi=(jn.prototype._parseStoresSpec=function(e,t){w(e).forEach(function(n){if(e[n]!==null){var r=Br(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new E.Schema("Primary key cannot be multi-valued");r.forEach(function(a){if(a.auto)throw new E.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new E.Schema("Index must have a name and cannot be an empty string")}),t[n]=Wn(n,i,r)}})},jn.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?se(this._cfg.storesSource,n):n;var n=t._versions,r={},i={};return n.forEach(function(a){se(r,a._cfg.storesSource),i=a._cfg.dbschema={},a._parseStoresSpec(r,i)}),t._dbSchema=i,Qn(t,[t._allTables,t,t.Transaction.prototype]),xn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],w(i),i),t._storeNames=w(i),this},jn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Kt(this._cfg.contentUpgrade||ie,e),this},jn);function jn(){}function er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Ht(qt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function tr(e){return e&&typeof e.databases=="function"}function nr(e){return ft(function(){return k.letThrough=!0,e()})}function rr(e){return!("from"in e)}var jt=function(e,t){if(!this){var n=new jt;return e&&"d"in e&&se(n,e),n}se(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function gn(e,t,n){var r=Ve(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(rr(e))return se(e,{from:t,to:n,d:1});var i=e.l,r=e.r;if(Ve(n,e.from)<0)return i?gn(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Kr(e);if(0<Ve(t,e.to))return r?gn(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Kr(e);Ve(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<Ve(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,i&&!e.l&&wn(e,i),r&&n&&wn(e,r)}}function wn(e,t){rr(t)||function n(r,v){var a=v.from,c=v.to,f=v.l,v=v.r;gn(r,a,c),f&&n(r,f),v&&n(r,v)}(e,t)}function Cn(e,t){var n=ir(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=ir(e),c=a.next(i.from),f=c.value;!r.done&&!c.done;){if(Ve(f.from,i.to)<=0&&0<=Ve(f.to,i.from))return!0;Ve(i.from,f.from)<0?i=(r=n.next(f.from)).value:f=(c=a.next(i.from)).value}return!1}function ir(e){var t=rr(e)?null:{s:0,n:e};return{next:function(n){for(var r=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&Ve(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||Ve(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Kr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=1<r?"r":r<-1?"l":"";i&&(t=i=="r"?"l":"r",n=j({},e),r=e[i],e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],(e[t]=n).d=Rr(n)),e.d=Rr(e)}function Rr(n){var t=n.r,n=n.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function In(e,t){return w(t).forEach(function(n){e[n]?wn(e[n],t[n]):e[n]=function r(i){var a,c,f={};for(a in i)le(i,a)&&(c=i[a],f[a]=!c||typeof c!="object"||M.has(c.constructor)?c:r(c));return f}(t[n])}),e}function or(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&Cn(t[n],e[n])})}Ye(jt.prototype,((Mt={add:function(e){return wn(this,e),this},addKey:function(e){return gn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return gn(t,n,n)}),this}})[Ge]=function(){return ir(this)},Mt));var on={},ar={},ur=!1;function Bn(e){In(ar,e),ur||(ur=!0,setTimeout(function(){ur=!1,sr(ar,!(ar={}))},0))}function sr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(on);r<i.length;r++)Dr(c=i[r],e,n,t);else for(var a in e){var c,f=/^idb\:\/\/(.*)\/(.*)\//.exec(a);f&&(a=f[1],f=f[2],(c=on["idb://".concat(a,"/").concat(f)])&&Dr(c,e,n,t))}n.forEach(function(v){return v()})}function Dr(e,t,n,r){for(var i=[],a=0,c=Object.entries(e.queries.query);a<c.length;a++){for(var f=c[a],v=f[0],d=[],_=0,p=f[1];_<p.length;_++){var O=p[_];or(t,O.obsSet)?O.subscribers.forEach(function(m){return n.add(m)}):r&&d.push(O)}r&&i.push([v,d])}if(r)for(var y=0,b=i;y<b.length;y++){var S=b[y],v=S[0],d=S[1];e.queries.query[v]=d}}function di(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?He(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),a=!1;function c(){if(t.openCanceller!==r)throw new E.DatabaseClosed("db.open() was cancelled")}function f(){return new D(function(O,y){if(c(),!n)throw new E.MissingAPI;var b=e.name,S=t.autoSchema||!i?n.open(b):n.open(b,i);if(!S)throw new E.MissingAPI;S.onerror=Gt(y),S.onblocked=Q(e._fireOnBlocked),S.onupgradeneeded=Q(function(m){var A;_=S.transaction,t.autoSchema&&!e._options.allowEmptyDB?(S.onerror=yn,_.abort(),S.result.close(),(A=n.deleteDatabase(b)).onsuccess=A.onerror=Q(function(){y(new E.NoSuchDatabase("Database ".concat(b," doesnt exist")))})):(_.onerror=Gt(y),m=m.oldVersion>Math.pow(2,62)?0:m.oldVersion,p=m<1,e.idbdb=S.result,a&&pi(e,_),fi(e,m/10,_,y))},y),S.onsuccess=Q(function(){_=null;var m,A,x,I,R,L=e.idbdb=S.result,X=Ze(L.objectStoreNames);if(0<X.length)try{var $=L.transaction((I=X).length===1?I[0]:I,"readonly");if(t.autoSchema)A=L,x=$,(m=e).verno=A.version/10,x=m._dbSchema=Pn(0,A,x),m._storeNames=Ze(A.objectStoreNames,0),xn(m,[m._allTables],w(x),x);else if(Nn(e,e._dbSchema,$),((R=Xn(Pn(0,(R=e).idbdb,$),R._dbSchema)).add.length||R.change.some(function(z){return z.add.length||z.change.length}))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),i=L.version+1,a=!0,O(f());Tn(e,$)}catch{}Nt.push(e),L.onversionchange=Q(function(z){t.vcFired=!0,e.on("versionchange").fire(z)}),L.onclose=Q(function(z){e.on("close").fire(z)}),p&&(R=e._deps,$=b,L=R.indexedDB,R=R.IDBKeyRange,tr(L)||$===qt||er(L,R).put({name:$}).catch(ie)),O()},y)}).catch(function(O){switch(O==null?void 0:O.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),f();break;case"VersionError":if(0<i)return i=0,f()}return D.reject(O)})}var v,d=t.dbReadyResolve,_=null,p=!1;return D.race([r,(typeof navigator>"u"?D.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function y(){return indexedDB.databases().finally(O)}v=setInterval(y,100),y()}).finally(function(){return clearInterval(v)}):Promise.resolve()).then(f)]).then(function(){return c(),t.onReadyBeingFired=[],D.resolve(nr(function(){return e.on.ready.fire(e.vip)})).then(function O(){if(0<t.onReadyBeingFired.length){var y=t.onReadyBeingFired.reduce(Kt,ie);return t.onReadyBeingFired=[],D.resolve(nr(function(){return y(e.vip)})).then(O)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(O){t.dbOpenError=O;try{_&&_.abort()}catch{}return r===t.openCanceller&&e._close(),He(O)}).finally(function(){t.openComplete=!0,d()}).then(function(){var O;return p&&(O={},e.tables.forEach(function(y){y.schema.indexes.forEach(function(b){b.name&&(O["idb://".concat(e.name,"/").concat(y.name,"/").concat(b.name)]=new jt(-1/0,[[[]]]))}),O["idb://".concat(e.name,"/").concat(y.name,"/")]=O["idb://".concat(e.name,"/").concat(y.name,"/:dels")]=new jt(-1/0,[[[]]])}),en(vn).fire(O),sr(O,!0)),e})}function cr(e){function t(a){return e.next(a)}var n=i(t),r=i(function(a){return e.throw(a)});function i(a){return function(v){var f=a(v),v=f.value;return f.done?v:v&&typeof v.then=="function"?v.then(n,r):H(v)?Promise.all(v).then(n,r):n(v)}}return i(t)()}function Kn(e,t,n){for(var r=H(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var yi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return j(j({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function c(p,O,y){var b=bn(p),S=i[b]=i[b]||[],m=p==null?0:typeof p=="string"?1:p.length,A=0<O,A=j(j({},y),{name:A?"".concat(b,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:A,keyTail:O,keyLength:m,extractKey:Hn(p),unique:!A&&y.unique});return S.push(A),A.isPrimaryKey||a.push(A),1<m&&c(m===2?p[0]:p.slice(0,m-1),O+1,y),S.sort(function(x,I){return x.keyTail-I.keyTail}),A}t=c(r.primaryKey.keyPath,0,r.primaryKey),i[":id"]=[t];for(var f=0,v=r.indexes;f<v.length;f++){var d=v[f];c(d.keyPath,0,d)}function _(p){var O,y=p.query.index;return y.isVirtual?j(j({},p),{query:{index:y.lowLevelIndex,range:(O=p.query.range,y=y.keyTail,{type:O.type===1?2:O.type,lower:Kn(O.lower,O.lowerOpen?e.MAX_KEY:e.MIN_KEY,y),lowerOpen:!0,upper:Kn(O.upper,O.upperOpen?e.MIN_KEY:e.MAX_KEY,y),upperOpen:!0})}}):p}return j(j({},n),{schema:j(j({},r),{primaryKey:t,indexes:a,getIndexByKeyPath:function(p){return(p=i[bn(p)])&&p[0]}}),count:function(p){return n.count(_(p))},query:function(p){return n.query(_(p))},openCursor:function(p){var O=p.query.index,y=O.keyTail,b=O.isVirtual,S=O.keyLength;return b?n.openCursor(_(p)).then(function(A){return A&&m(A)}):n.openCursor(p);function m(A){return Object.create(A,{continue:{value:function(x){x!=null?A.continue(Kn(x,p.reverse?e.MAX_KEY:e.MIN_KEY,y)):p.unique?A.continue(A.key.slice(0,S).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,y)):A.continue()}},continuePrimaryKey:{value:function(x,I){A.continuePrimaryKey(Kn(x,e.MAX_KEY,y),I)}},primaryKey:{get:function(){return A.primaryKey}},key:{get:function(){var x=A.key;return S===1?x[0]:x.slice(0,S)}},value:{get:function(){return A.value}}})}}})}})}};function lr(e,t,n,r){return n=n||{},r=r||"",w(e).forEach(function(i){var a,c,f;le(t,i)?(a=e[i],c=t[i],typeof a=="object"&&typeof c=="object"&&a&&c?(f=Fe(a))!==Fe(c)?n[r+i]=t[i]:f==="Object"?lr(a,c,n,r+i+"."):a!==c&&(n[r+i]=t[i]):a!==c&&(n[r+i]=t[i])):n[r+i]=void 0}),w(t).forEach(function(i){le(e,i)||(n[r+i]=t[i])}),n}function fr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var vi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return j(j({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return j(j({},n),{mutate:function(i){var a=k.trans,c=a.table(t).hook,f=c.deleting,v=c.creating,d=c.updating;switch(i.type){case"add":if(v.fire===ie)break;return a._promise("readwrite",function(){return _(i)},!0);case"put":if(v.fire===ie&&d.fire===ie)break;return a._promise("readwrite",function(){return _(i)},!0);case"delete":if(f.fire===ie)break;return a._promise("readwrite",function(){return _(i)},!0);case"deleteRange":if(f.fire===ie)break;return a._promise("readwrite",function(){return function p(O,y,b){return n.query({trans:O,values:!1,query:{index:r,range:y},limit:b}).then(function(S){var m=S.result;return _({type:"delete",keys:m,trans:O}).then(function(A){return 0<A.numFailures?Promise.reject(A.failures[0]):m.length<b?{failures:[],numFailures:0,lastResult:void 0}:p(O,j(j({},y),{lower:m[m.length-1],lowerOpen:!0}),b)})})}(i.trans,i.range,1e4)},!0)}return n.mutate(i);function _(p){var O,y,b,S=k.trans,m=p.keys||fr(r,p);if(!m)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?j(j({},p),{keys:m}):j({},p)).type!=="delete"&&(p.values=Y([],p.values)),p.keys&&(p.keys=Y([],p.keys)),O=n,b=m,((y=p).type==="add"?Promise.resolve([]):O.getMany({trans:y.trans,keys:b,cache:"immutable"})).then(function(A){var x=m.map(function(I,R){var L,X,$,z=A[R],Z={onerror:null,onsuccess:null};return p.type==="delete"?f.fire.call(Z,I,z,S):p.type==="add"||z===void 0?(L=v.fire.call(Z,I,p.values[R],S),I==null&&L!=null&&(p.keys[R]=I=L,r.outbound||ge(p.values[R],r.keyPath,I))):(L=lr(z,p.values[R]),(X=d.fire.call(Z,L,I,z,S))&&($=p.values[R],Object.keys(X).forEach(function(te){le($,te)?$[te]=X[te]:ge($,te,X[te])}))),Z});return n.mutate(p).then(function(I){for(var R=I.failures,L=I.results,X=I.numFailures,I=I.lastResult,$=0;$<m.length;++$){var z=(L||m)[$],Z=x[$];z==null?Z.onerror&&Z.onerror(R[$]):Z.onsuccess&&Z.onsuccess(p.type==="put"&&A[$]?p.values[$]:z)}return{failures:R,results:L,numFailures:X,lastResult:I}}).catch(function(I){return x.forEach(function(R){return R.onerror&&R.onerror(I)}),Promise.reject(I)})})}}})}})}};function Fr(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)Ve(t.keys[i],e[a])===0&&(r.push(n?Oe(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var mi={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return j(j({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=Fr(r.keys,r.trans._cache,r.cache==="clone");return i?D.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Oe(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function Lr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Ur(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var bi={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new jt(e.MIN_KEY,e.MAX_KEY);return j(j({},e),{transaction:function(r,i,a){if(k.subscr&&i!=="readonly")throw new E.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(k.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,c=a.primaryKey,p=a.indexes,f=c.extractKey,v=c.outbound,d=c.autoIncrement&&p.filter(function(y){return y.compound&&y.keyPath.includes(c.keyPath)}),_=j(j({},i),{mutate:function(y){function b(te){return te="idb://".concat(t,"/").concat(r,"/").concat(te),I[te]||(I[te]=new jt)}var S,m,A,x=y.trans,I=y.mutatedParts||(y.mutatedParts={}),R=b(""),L=b(":dels"),X=y.type,Z=y.type==="deleteRange"?[y.range]:y.type==="delete"?[y.keys]:y.values.length<50?[fr(c,y).filter(function(te){return te}),y.values]:[],$=Z[0],z=Z[1],Z=y.trans._cache;return H($)?(R.addKeys($),(Z=X==="delete"||$.length===z.length?Fr($,Z):null)||L.addKeys($),(Z||z)&&(S=b,m=Z,A=z,a.indexes.forEach(function(te){var ye=S(te.name||"");function xe(ke){return ke!=null?te.extractKey(ke):null}function Ne(ke){return te.multiEntry&&H(ke)?ke.forEach(function(Jt){return ye.addKey(Jt)}):ye.addKey(ke)}(m||A).forEach(function(ke,Ct){var Pe=m&&xe(m[Ct]),Ct=A&&xe(A[Ct]);Ve(Pe,Ct)!==0&&(Pe!=null&&Ne(Pe),Ct!=null&&Ne(Ct))})}))):$?(z={from:$.lower,to:$.upper},L.add(z),R.add(z)):(R.add(n),L.add(n),a.indexes.forEach(function(te){return b(te.name).add(n)})),i.mutate(y).then(function(te){return!$||y.type!=="add"&&y.type!=="put"||(R.addKeys(te.results),d&&d.forEach(function(ye){var xe=y.values.map(function(ke){return ye.extractKey(ke)}),Ne=ye.keyPath.findIndex(function(ke){return ke===c.keyPath});te.results.forEach(function(ke){return xe[Ne]=ke}),b(ye.name).addKeys(xe)})),x.mutatedParts=In(x.mutatedParts||{},I),te})}}),p=function(b){var S=b.query,b=S.index,S=S.range;return[b,new jt((b=S.lower)!==null&&b!==void 0?b:e.MIN_KEY,(S=S.upper)!==null&&S!==void 0?S:e.MAX_KEY)]},O={get:function(y){return[c,new jt(y.key)]},getMany:function(y){return[c,new jt().addKeys(y.keys)]},count:p,query:p,openCursor:p};return w(O).forEach(function(y){_[y]=function(b){var S=k.subscr,m=!!S,A=Lr(k,i)&&Ur(y,b)?b.obsSet={}:S;if(m){var x=function(z){return z="idb://".concat(t,"/").concat(r,"/").concat(z),A[z]||(A[z]=new jt)},I=x(""),R=x(":dels"),S=O[y](b),m=S[0],S=S[1];if((y==="query"&&m.isPrimaryKey&&!b.values?R:x(m.name||"")).add(S),!m.isPrimaryKey){if(y!=="count"){var L=y==="query"&&v&&b.values&&i.query(j(j({},b),{values:!1}));return i[y].apply(this,arguments).then(function(z){if(y==="query"){if(v&&b.values)return L.then(function(xe){return xe=xe.result,I.addKeys(xe),z});var Z=b.values?z.result.map(f):z.result;(b.values?I:R).addKeys(Z)}else if(y==="openCursor"){var te=z,ye=b.values;return te&&Object.create(te,{key:{get:function(){return R.addKey(te.primaryKey),te.key}},primaryKey:{get:function(){var xe=te.primaryKey;return R.addKey(xe),xe}},value:{get:function(){return ye&&I.addKey(te.primaryKey),te.value}}})}return z})}R.add(n)}}return i[y].apply(this,arguments)}}),_}})}};function qr(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return n.numFailures===r?null:(t=j({},t),H(t.keys)&&(t.keys=t.keys.filter(function(i,a){return!(a in n.failures)})),"values"in t&&H(t.values)&&(t.values=t.values.filter(function(i,a){return!(a in n.failures)})),t)}function pr(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<Ve(n,r.lower):0<=Ve(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Ve(e,t.upper)<0:Ve(e,t.upper)<=0));var n,r}function Mr(e,t,O,r,i,a){if(!O||O.length===0)return e;var c=t.query.index,f=c.multiEntry,v=t.query.range,d=r.schema.primaryKey.extractKey,_=c.extractKey,p=(c.lowLevelIndex||c).extractKey,O=O.reduce(function(y,b){var S=y,m=b.type==="add"||b.type==="put"?b.values.filter(function(R){return R=_(R),f&&H(R)?R.some(function(L){return pr(L,v)}):pr(R,v)}).map(function(R){return R=Oe(R),a&&Object.freeze(R),R}):[];switch(b.type){case"add":S=y.concat(t.values?m:m.map(function(L){return d(L)}));break;case"put":var A=new jt().addKeys(b.values.map(function(L){return d(L)})),S=y.filter(function(L){return L=t.values?d(L):L,!Cn(new jt(L),A)}).concat(t.values?m:m.map(function(L){return d(L)}));break;case"delete":var x=new jt().addKeys(b.keys);S=y.filter(function(L){return L=t.values?d(L):L,!Cn(new jt(L),x)});break;case"deleteRange":var I=b.range;S=y.filter(function(L){return!pr(d(L),I)})}return S},e);return O===e?e:(O.sort(function(y,b){return Ve(p(y),p(b))||Ve(d(y),d(b))}),t.limit&&t.limit<1/0&&(O.length>t.limit?O.length=t.limit:e.length===t.limit&&O.length<t.limit&&(i.dirty=!0)),a?Object.freeze(O):O)}function Vr(e,t){return Ve(e.lower,t.lower)===0&&Ve(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function gi(e,t){return function(n,r,i,a){if(n===void 0)return r!==void 0?-1:0;if(r===void 0)return 1;if((r=Ve(n,r))===0){if(i&&a)return 0;if(i)return 1;if(a)return-1}return r}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(n,r,i,a){if(n===void 0)return r!==void 0?1:0;if(r===void 0)return-1;if((r=Ve(n,r))===0){if(i&&a)return 0;if(i)return-1;if(a)return 1}return r}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function wi(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){var i,a;e.subscribers.delete(n),e.subscribers.size===0&&(i=e,a=t,setTimeout(function(){i.subscribers.size===0&&st(a,i)},3e3))})}var _i={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return j(j({},e),{transaction:function(n,r,i){var a,c,f=e.transaction(n,r,i);return r==="readwrite"&&(c=(a=new AbortController).signal,i=function(v){return function(){if(a.abort(),r==="readwrite"){for(var d=new Set,_=0,p=n;_<p.length;_++){var O=p[_],y=on["idb://".concat(t,"/").concat(O)];if(y){var b=e.table(O),S=y.optimisticOps.filter(function(ye){return ye.trans===f});if(f._explicit&&v&&f.mutatedParts)for(var m=0,A=Object.values(y.queries.query);m<A.length;m++)for(var x=0,I=(X=A[m]).slice();x<I.length;x++)or(($=I[x]).obsSet,f.mutatedParts)&&(st(X,$),$.subscribers.forEach(function(ye){return d.add(ye)}));else if(0<S.length){y.optimisticOps=y.optimisticOps.filter(function(ye){return ye.trans!==f});for(var R=0,L=Object.values(y.queries.query);R<L.length;R++)for(var X,$,z,Z=0,te=(X=L[R]).slice();Z<te.length;Z++)($=te[Z]).res!=null&&f.mutatedParts&&(v&&!$.dirty?(z=Object.isFrozen($.res),z=Mr($.res,$.req,S,b,$,z),$.dirty?(st(X,$),$.subscribers.forEach(function(ye){return d.add(ye)})):z!==$.res&&($.res=z,$.promise=D.resolve({result:z}))):($.dirty&&st(X,$),$.subscribers.forEach(function(ye){return d.add(ye)})))}}}d.forEach(function(ye){return ye()})}}},f.addEventListener("abort",i(!1),{signal:c}),f.addEventListener("error",i(!1),{signal:c}),f.addEventListener("complete",i(!0),{signal:c})),f},table:function(n){var r=e.table(n),i=r.schema.primaryKey;return j(j({},r),{mutate:function(a){var c=k.trans;if(i.outbound||c.db._options.cache==="disabled"||c.explicit)return r.mutate(a);var f=on["idb://".concat(t,"/").concat(n)];return f?(c=r.mutate(a),a.type!=="add"&&a.type!=="put"||!(50<=a.values.length||fr(i,a).some(function(v){return v==null}))?(f.optimisticOps.push(a),a.mutatedParts&&Bn(a.mutatedParts),c.then(function(v){0<v.numFailures&&(st(f.optimisticOps,a),(v=qr(0,a,v))&&f.optimisticOps.push(v),a.mutatedParts&&Bn(a.mutatedParts))}),c.catch(function(){st(f.optimisticOps,a),a.mutatedParts&&Bn(a.mutatedParts)})):c.then(function(v){var d=qr(0,j(j({},a),{values:a.values.map(function(y,p){var O,y=(O=i.keyPath)!==null&&O!==void 0&&O.includes(".")?Oe(y):j({},y);return ge(y,i.keyPath,v.results[p]),y})}),v);f.optimisticOps.push(d),queueMicrotask(function(){return a.mutatedParts&&Bn(a.mutatedParts)})}),c):r.mutate(a)},query:function(a){if(!Lr(k,r)||!Ur("query",a))return r.query(a);var c=((d=k.trans)===null||d===void 0?void 0:d.db._options.cache)==="immutable",p=k,f=p.requery,v=p.signal,d=function(b,S,m,A){var x=on["idb://".concat(b,"/").concat(S)];if(!x)return[];if(!(S=x.queries[m]))return[null,!1,x,null];var I=S[(A.query?A.query.index.name:null)||""];if(!I)return[null,!1,x,null];switch(m){case"query":var R=I.find(function(L){return L.req.limit===A.limit&&L.req.values===A.values&&Vr(L.req.query.range,A.query.range)});return R?[R,!0,x,I]:[I.find(function(L){return("limit"in L.req?L.req.limit:1/0)>=A.limit&&(!A.values||L.req.values)&&gi(L.req.query.range,A.query.range)}),!1,x,I];case"count":return R=I.find(function(L){return Vr(L.req.query.range,A.query.range)}),[R,!!R,x,I]}}(t,n,"query",a),_=d[0],p=d[1],O=d[2],y=d[3];return _&&p?_.obsSet=a.obsSet:(p=r.query(a).then(function(b){var S=b.result;if(_&&(_.res=S),c){for(var m=0,A=S.length;m<A;++m)Object.freeze(S[m]);Object.freeze(S)}else b.result=Oe(S);return b}).catch(function(b){return y&&_&&st(y,_),Promise.reject(b)}),_={obsSet:a.obsSet,promise:p,subscribers:new Set,type:"query",req:a,dirty:!1},y?y.push(_):(y=[_],(O=O||(on["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[a.query.index.name||""]=y)),wi(_,y,f,v),_.promise.then(function(b){return{result:Mr(b.result,a,O==null?void 0:O.optimisticOps,r,_,c)}})}})}})}};function Rn(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var Ht=(ht.prototype.version=function(e){if(isNaN(e)||e<.1)throw new E.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new E.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(r){return r._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(li),n.stores({}),this._state.autoSchema=!1,n)},ht.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||k.letThrough||this._vip)?e():new D(function(n,r){if(t._state.openComplete)return r(new E.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void r(new E.DatabaseClosed);t.open().catch(ie)}t._state.dbReadyPromise.then(n,r)}).then(e)},ht.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:i}),e.sort(function(a,c){return a.level-c.level}),this},ht.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(i){return r?i.create!==r:!!n&&i.name!==n})),this},ht.prototype.open=function(){var e=this;return vt(g,function(){return di(e)})},ht.prototype._close=function(){var e=this._state,t=Nt.indexOf(this);if(0<=t&&Nt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new D(function(n){e.dbReadyResolve=n}),e.openCanceller=new D(function(n,r){e.cancelOpen=r}))},ht.prototype.close=function(n){var t=(n===void 0?{disableAutoOpen:!0}:n).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new E.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new E.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},ht.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!="object",r=this._state;return new D(function(i,a){function c(){t.close(e);var f=t._deps.indexedDB.deleteDatabase(t.name);f.onsuccess=Q(function(){var v,d,_;v=t._deps,d=t.name,_=v.indexedDB,v=v.IDBKeyRange,tr(_)||d===qt||er(_,v).delete(d).catch(ie),i()}),f.onerror=Gt(a),f.onblocked=t._fireOnBlocked}if(n)throw new E.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(c):c()})},ht.prototype.backendDB=function(){return this.idbdb},ht.prototype.isOpen=function(){return this.idbdb!==null},ht.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},ht.prototype.hasFailed=function(){return this._state.dbOpenError!==null},ht.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ht.prototype,"tables",{get:function(){var e=this;return w(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),ht.prototype.transaction=function(){var e=(function(t,n,r){var i=arguments.length;if(i<2)throw new E.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];return r=a.pop(),[t,l(a),r]}).apply(this,arguments);return this._transaction.apply(this,e)},ht.prototype._transaction=function(e,t,n){var r=this,i=k.trans;i&&i.db===this&&e.indexOf("!")===-1||(i=null);var a,c,f=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(c=t.map(function(d){if(d=d instanceof r.Table?d.name:d,typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),e=="r"||e===Xt)a=Xt;else{if(e!="rw"&&e!=Mn)throw new E.InvalidArgument("Invalid transaction mode: "+e);a=Mn}if(i){if(i.mode===Xt&&a===Mn){if(!f)throw new E.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&c.forEach(function(d){if(i&&i.storeNames.indexOf(d)===-1){if(!f)throw new E.SubTransaction("Table "+d+" not included in parent transaction.");i=null}}),f&&i&&!i.active&&(i=null)}}catch(d){return i?i._promise(null,function(_,p){p(d)}):He(d)}var v=(function d(_,p,O,y,b){return D.resolve().then(function(){var S=k.transless||k,m=_._createTransaction(p,O,_._dbSchema,y);if(m.explicit=!0,S={trans:m,transless:S},y)m.idbtrans=y.idbtrans;else try{m.create(),m.idbtrans._explicit=!0,_._state.PR1398_maxLoop=3}catch(I){return I.name===K.InvalidState&&_.isOpen()&&0<--_._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),_.close({disableAutoOpen:!1}),_.open().then(function(){return d(_,p,O,null,b)})):He(I)}var A,x=Qe(b);return x&&Re(),S=D.follow(function(){var I;(A=b.call(m,m))&&(x?(I=pt.bind(null,null),A.then(I,I)):typeof A.next=="function"&&typeof A.throw=="function"&&(A=cr(A)))},S),(A&&typeof A.then=="function"?D.resolve(A).then(function(I){return m.active?I:He(new E.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):S.then(function(){return A})).then(function(I){return y&&m._resolve(),m._completion.then(function(){return I})}).catch(function(I){return m._reject(I),He(I)})})}).bind(null,this,a,c,i,n);return i?i._promise(a,v,"lock"):k.trans?vt(k.transless,function(){return r._whenReady(v)}):this._whenReady(v)},ht.prototype.table=function(e){if(!le(this._allTables,e))throw new E.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ht);function ht(e,t){var n=this;this._middlewares={},this.verno=0;var r=ht.dependencies;this._options=t=j({addons:ht.addons,autoOpen:!0,indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},r=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var i,a,c,f,v,d={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ie,dbReadyPromise:null,cancelOpen:ie,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};d.dbReadyPromise=new D(function(p){d.dbReadyResolve=p}),d.openCanceller=new D(function(p,O){d.cancelOpen=O}),this._state=d,this.name=e,this.on=hn(this,"populate","blocked","versionchange","close",{ready:[Kt,ie]}),this.on.ready.subscribe=oe(this.on.ready.subscribe,function(p){return function(O,y){ht.vip(function(){var b,S=n._state;S.openComplete?(S.dbOpenError||D.resolve().then(O),y&&p(O)):S.onReadyBeingFired?(S.onReadyBeingFired.push(O),y&&p(O)):(p(O),b=n,y||p(function m(){b.on.ready.unsubscribe(O),b.on.ready.unsubscribe(m)}))})}}),this.Collection=(i=this,dn(ri.prototype,function(A,m){this.db=i;var y=_r,b=null;if(m)try{y=m()}catch(x){b=x}var S=A._ctx,m=S.table,A=m.hook.reading.fire;this._ctx={table:m,index:S.index,isPrimKey:!S.index||m.schema.primKey.keyPath&&S.index===m.schema.primKey.name,range:y,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:b,or:S.or,valueMapper:A!==Ee?A:null}})),this.Table=(a=this,dn(Ar.prototype,function(p,O,y){this.db=a,this._tx=y,this.name=p,this.schema=O,this.hook=a._allTables[p]?a._allTables[p].hook:hn(null,{creating:[yt,ie],reading:[Ie,Ee],updating:[Bt,ie],deleting:[xt,ie]})})),this.Transaction=(c=this,dn(ai.prototype,function(p,O,y,b,S){var m=this;this.db=c,this.mode=p,this.storeNames=O,this.schema=y,this.chromeTransactionDurability=b,this.idbtrans=null,this.on=hn(this,"complete","error","abort"),this.parent=S||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new D(function(A,x){m._resolve=A,m._reject=x}),this._completion.then(function(){m.active=!1,m.on.complete.fire()},function(A){var x=m.active;return m.active=!1,m.on.error.fire(A),m.parent?m.parent._reject(A):x&&m.idbtrans&&m.idbtrans.abort(),He(A)})})),this.Version=(f=this,dn(hi.prototype,function(p){this.db=f,this._cfg={version:p,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(v=this,dn(Nr.prototype,function(p,O,y){if(this.db=v,this._ctx={table:p,index:O===":id"?null:O,or:y},this._cmp=this._ascending=Ve,this._descending=function(b,S){return Ve(S,b)},this._max=function(b,S){return 0<Ve(b,S)?b:S},this._min=function(b,S){return Ve(b,S)<0?b:S},this._IDBKeyRange=v._deps.IDBKeyRange,!this._IDBKeyRange)throw new E.MissingAPI})),this.on("versionchange",function(p){0<p.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=mn(t.IDBKeyRange),this._createTransaction=function(p,O,y,b){return new n.Transaction(p,O,y,n._options.chromeTransactionDurability,b)},this._fireOnBlocked=function(p){n.on("blocked").fire(p),Nt.filter(function(O){return O.name===n.name&&O!==n&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(p)})},this.use(mi),this.use(_i),this.use(bi),this.use(yi),this.use(vi);var _=new Proxy(this,{get:function(p,O,y){if(O==="_vip")return!0;if(O==="table")return function(S){return Rn(n.table(S),_)};var b=Reflect.get(p,O,y);return b instanceof Ar?Rn(b,_):O==="tables"?b.map(function(S){return Rn(S,_)}):O==="_createTransaction"?function(){return Rn(b.apply(this,arguments),_)}:b}});this.vip=_,r.forEach(function(p){return p(n)})}var Dn,Mt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Oi=(hr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:n})},hr.prototype[Mt]=function(){return this},hr);function hr(e){this._subscribe=e}try{Dn={indexedDB:C.indexedDB||C.mozIndexedDB||C.webkitIndexedDB||C.msIndexedDB,IDBKeyRange:C.IDBKeyRange||C.webkitIDBKeyRange}}catch{Dn={indexedDB:null,IDBKeyRange:null}}function $r(e){var t,n=!1,r=new Oi(function(i){var a=Qe(e),c,f=!1,v={},d={},_={get closed(){return f},unsubscribe:function(){f||(f=!0,c&&c.abort(),p&&en.storagemutated.unsubscribe(y))}};i.start&&i.start(_);var p=!1,O=function(){return Qt(b)},y=function(S){In(v,S),or(d,v)&&O()},b=function(){var S,m,A;!f&&Dn.indexedDB&&(v={},S={},c&&c.abort(),c=new AbortController,A=function(x){var I=de();try{a&&Re();var R=ft(e,x);return R=a?R.finally(pt):R}finally{I&&rt()}}(m={subscr:S,signal:c.signal,requery:O,querier:e,trans:null}),Promise.resolve(A).then(function(x){n=!0,t=x,f||m.signal.aborted||(v={},function(I){for(var R in I)if(le(I,R))return;return 1}(d=S)||p||(en(vn,y),p=!0),Qt(function(){return!f&&i.next&&i.next(x)}))},function(x){n=!1,["DatabaseClosedError","AbortError"].includes(x==null?void 0:x.name)||f||Qt(function(){f||i.error&&i.error(x)})}))};return setTimeout(O,0),_});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var an=Ht;function dr(e){var t=tn;try{tn=!0,en.storagemutated.fire(e),sr(e,!0)}finally{tn=t}}Ye(an,j(j({},G),{delete:function(e){return new an(e,{addons:[]}).delete()},exists:function(e){return new an(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=an.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(tr(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==qt})}):er(n,t).toCollection().primaryKeys()).then(e)}catch{return He(new E.MissingAPI)}var t,n},defineClass:function(){return function(e){se(this,e)}},ignoreTransaction:function(e){return k.trans?vt(k.transless,e):e()},vip:nr,async:function(e){return function(){try{var t=cr(e.apply(this,arguments));return t&&typeof t.then=="function"?t:D.resolve(t)}catch(n){return He(n)}}},spawn:function(e,t,n){try{var r=cr(e.apply(n,t||[]));return r&&typeof r.then=="function"?r:D.resolve(r)}catch(i){return He(i)}},currentTransaction:{get:function(){return k.trans||null}},waitFor:function(e,t){return t=D.resolve(typeof e=="function"?an.ignoreTransaction(e):e).timeout(t||6e4),k.trans?k.trans.waitFor(t):t},Promise:D,debug:{get:function(){return dt},set:function(e){kt(e)}},derive:be,extend:se,props:Ye,override:oe,Events:hn,on:en,liveQuery:$r,extendObservabilitySet:In,getByKeyPath:Ae,setByKeyPath:ge,delByKeyPath:function(e,t){typeof t=="string"?ge(e,t,void 0):"length"in t&&[].map.call(t,function(n){ge(e,n,void 0)})},shallowClone:bt,deepClone:Oe,getObjectDiff:lr,cmp:Ve,asap:he,minKey:-1/0,addons:[],connections:Nt,errnames:K,dependencies:Dn,cache:on,semVer:"4.0.4",version:"4.0.4".split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),an.maxKey=mn(an.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(en(vn,function(e){tn||(e=new CustomEvent(Gn,{detail:e}),tn=!0,dispatchEvent(e),tn=!1)}),addEventListener(Gn,function(e){e=e.detail,tn||dr(e)}));var fn,tn=!1,Jr=function(){};return typeof BroadcastChannel<"u"&&((Jr=function(){(fn=new BroadcastChannel(Gn)).onmessage=function(e){return e.data&&dr(e.data)}})(),typeof fn.unref=="function"&&fn.unref(),en(vn,function(e){tn||fn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Ht.disableBfCache&&e.persisted){dt&&console.debug("Dexie: handling persisted pagehide"),fn!=null&&fn.close();for(var t=0,n=Nt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!Ht.disableBfCache&&e.persisted&&(dt&&console.debug("Dexie: handling persisted pageshow"),Jr(),dr({all:new jt(-1/0,[[]])}))})),D.rejectionMapper=function(e,t){return!e||e instanceof gt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!U[e.name]?e:(t=new U[e.name](t||e.message,e),"stack"in e&&ve(t,"stack",{get:function(){return this.inner.stack}}),t)},kt(dt),j(Ht,Object.freeze({__proto__:null,Dexie:Ht,liveQuery:$r,Entity:Or,cmp:Ve,PropModSymbol:Wt,PropModification:Jn,replacePrefix:function(e,t){return new Jn({replacePrefix:[e,t]})},default:Ht,RangeSet:jt,mergeRanges:wn,rangesOverlap:Cn}),{default:Ht}),Ht})})(Wr);var Ei=Wr.exports;const mr=Si(Ei),Gr=Symbol.for("Dexie"),At=globalThis[Gr]||(globalThis[Gr]=mr);if(mr.semVer!==At.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${mr.semVer} and ${At.semVer}`);const{liveQuery:Li,mergeRanges:Ui,rangesOverlap:qi,RangeSet:Mi,cmp:Vi,Entity:$i,PropModSymbol:Ji,PropModification:Yi,replacePrefix:Gi}=At;var zr={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function nn(q,V,N,j){function Y(C){return C instanceof N?C:new N(function(w){w(C)})}return new(N||(N=Promise))(function(C,w){function H(re){try{T(j.next(re))}catch(le){w(le)}}function se(re){try{T(j.throw(re))}catch(le){w(le)}}function T(re){re.done?C(re.value):Y(re.value).then(H,se)}T((j=j.apply(q,[])).next())})}function Yt(q,V){var N={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},j,Y,C,w;return w={next:H(0),throw:H(1),return:H(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function H(T){return function(re){return se([T,re])}}function se(T){if(j)throw new TypeError("Generator is already executing.");for(;N;)try{if(j=1,Y&&(C=T[0]&2?Y.return:T[0]?Y.throw||((C=Y.return)&&C.call(Y),0):Y.next)&&!(C=C.call(Y,T[1])).done)return C;switch(Y=0,C&&(T=[T[0]&2,C.value]),T[0]){case 0:case 1:C=T;break;case 4:return N.label++,{value:T[1],done:!1};case 5:N.label++,Y=T[1],T=[0];continue;case 7:T=N.ops.pop(),N.trys.pop();continue;default:if(C=N.trys,!(C=C.length>0&&C[C.length-1])&&(T[0]===6||T[0]===2)){N=0;continue}if(T[0]===3&&(!C||T[1]>C[0]&&T[1]<C[3])){N.label=T[1];break}if(T[0]===6&&N.label<C[1]){N.label=C[1],C=T;break}if(C&&N.label<C[2]){N.label=C[2],N.ops.push(T);break}C[2]&&N.ops.pop(),N.trys.pop();continue}T=V.call(q,N)}catch(re){T=[6,re],Y=0}finally{j=C=0}if(T[0]&5)throw T[1];return{value:T[0]?T[1]:void 0,done:!0}}}function Ai(q){var V=[q.schema.primKey].concat(q.schema.indexes);return V.map(function(N){return N.src}).join(",")}function Ti(q){for(var V={},N=0,j=q.tables;N<j.length;N++){var Y=j[N];V[Y.name]=Y.schema}return V}function Hr(q,V){return new Promise(function(N,j){var Y=new FileReader;Y.onabort=function(C){return j(new Error("file read aborted"))},Y.onerror=function(C){return j(C.target.error)},Y.onload=function(C){return N(C.target.result)},V==="binary"?Y.readAsArrayBuffer(q):Y.readAsText(q)})}function Qr(q,V){if(typeof FileReaderSync>"u")throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var N=new FileReaderSync,j=V==="binary"?N.readAsArrayBuffer(q):N.readAsText(q);return j}var br=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wr(q,V){return V={exports:{}},q(V,V.exports),V.exports}var qn=wr(function(q,V){(function(N,j){q.exports=j()})(br,function(){function N(K){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?N=function(F){return typeof F}:N=function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},N(K)}function j(K,F,E,U,G,ie,Ee){try{var Ie=K[ie](Ee),ce=Ie.value}catch(yt){E(yt);return}Ie.done?F(ce):Promise.resolve(ce).then(U,G)}function Y(K){return function(){var F=this,E=arguments;return new Promise(function(U,G){var ie=K.apply(F,E);function Ee(ce){j(ie,U,G,Ee,Ie,"next",ce)}function Ie(ce){j(ie,U,G,Ee,Ie,"throw",ce)}Ee(void 0)})}}function C(K,F){if(!(K instanceof F))throw new TypeError("Cannot call a class as a function")}function w(K,F){for(var E=0;E<F.length;E++){var U=F[E];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(K,U.key,U)}}function H(K,F,E){return F&&w(K.prototype,F),K}function se(K,F,E){return F in K?Object.defineProperty(K,F,{value:E,enumerable:!0,configurable:!0,writable:!0}):K[F]=E,K}function T(K,F){var E=Object.keys(K);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(K);F&&(U=U.filter(function(G){return Object.getOwnPropertyDescriptor(K,G).enumerable})),E.push.apply(E,U)}return E}function re(K){for(var F=1;F<arguments.length;F++){var E=arguments[F]!=null?arguments[F]:{};F%2?T(Object(E),!0).forEach(function(U){se(K,U,E[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(E)):T(Object(E)).forEach(function(U){Object.defineProperty(K,U,Object.getOwnPropertyDescriptor(E,U))})}return K}function le(K,F){return ve(K)||Ue(K,F)||Ze()}function Ye(K){return ot(K)||be(K)||mt()}function ot(K){if(Array.isArray(K)){for(var F=0,E=new Array(K.length);F<K.length;F++)E[F]=K[F];return E}}function ve(K){if(Array.isArray(K))return K}function be(K){if(Symbol.iterator in Object(K)||Object.prototype.toString.call(K)==="[object Arguments]")return Array.from(K)}function Ue(K,F){if(Symbol.iterator in Object(K)||Object.prototype.toString.call(K)==="[object Arguments]"){var E=[],U=!0,G=!1,ie=void 0;try{for(var Ee=K[Symbol.iterator](),Ie;!(U=(Ie=Ee.next()).done)&&(E.push(Ie.value),!(F&&E.length===F));U=!0);}catch(ce){G=!0,ie=ce}finally{try{!U&&Ee.return!=null&&Ee.return()}finally{if(G)throw ie}}return E}}function mt(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Ze(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var oe=function K(F){C(this,K),this.p=new Promise(F)};oe.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(oe.prototype[Symbol.toStringTag]="TypesonPromise"),oe.prototype.then=function(K,F){var E=this;return new oe(function(U,G){E.p.then(function(ie){U(K?K(ie):ie)}).catch(function(ie){return F?F(ie):Promise.reject(ie)}).then(U,G)})},oe.prototype.catch=function(K){return this.then(null,K)},oe.resolve=function(K){return new oe(function(F){F(K)})},oe.reject=function(K){return new oe(function(F,E){E(K)})},["all","race"].forEach(function(K){oe[K]=function(F){return new oe(function(E,U){Promise[K](F.map(function(G){return G&&G.constructor&&G.constructor.__typeson__type__==="TypesonPromise"?G.p:G})).then(E,U)})}});var ct={},he=ct.toString,Ae={}.hasOwnProperty,ge=Object.getPrototypeOf,bt=Ae.toString;function P(K,F){return Se(K)&&typeof K.then=="function"&&(!F||typeof K.catch=="function")}function l(K){return he.call(K).slice(8,-1)}function M(K,F){if(!K||N(K)!=="object")return!1;var E=ge(K);if(!E)return F===null;var U=Ae.call(E,"constructor")&&E.constructor;return typeof U!="function"?F===null:F===U||F!==null&&bt.call(U)===bt.call(F)||typeof F=="function"&&typeof U.__typeson__type__=="string"&&U.__typeson__type__===F.__typeson__type__}function B(K){if(!K||l(K)!=="Object")return!1;var F=ge(K);return F?M(K,Object):!0}function Oe(K){if(!K||l(K)!=="Object")return!1;var F=ge(K);return F?M(K,Object)||Oe(F):!0}function Se(K){return K&&N(K)==="object"}function Fe(K){return K.replace(/~/g,"~0").replace(/\./g,"~1")}function Ge(K){return K.replace(/~1/g,".").replace(/~0/g,"~")}function ut(K,F){if(F==="")return K;var E=F.indexOf(".");if(E>-1){var U=K[Ge(F.slice(0,E))];return U===void 0?void 0:ut(U,F.slice(E+1))}return K[Ge(F)]}function st(K,F,E){if(F==="")return E;var U=F.indexOf(".");if(U>-1){var G=K[Ge(F.slice(0,U))];return st(G,F.slice(U+1),E)}return K[Ge(F)]=E,K}function at(K){return K===null?"null":Array.isArray(K)?"array":N(K)}var je=Object.keys,Qe=Array.isArray,Tt={}.hasOwnProperty,gt=["type","replaced","iterateIn","iterateUnsetNumeric"];function me(K,F){if(K.keypath==="")return-1;var E=K.keypath.match(/\./g)||0,U=F.keypath.match(/\./g)||0;return E&&(E=E.length),U&&(U=U.length),E>U?-1:E<U?1:K.keypath<F.keypath?-1:K.keypath>F.keypath}var $e=function(){function K(F){C(this,K),this.options=F,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return H(K,[{key:"stringify",value:function(E,U,G,ie){ie=re({},this.options,{},ie,{stringification:!0});var Ee=this.encapsulate(E,null,ie);return Qe(Ee)?JSON.stringify(Ee[0],U,G):Ee.then(function(Ie){return JSON.stringify(Ie,U,G)})}},{key:"stringifySync",value:function(E,U,G,ie){return this.stringify(E,U,G,re({throwOnBadSyncType:!0},ie,{sync:!0}))}},{key:"stringifyAsync",value:function(E,U,G,ie){return this.stringify(E,U,G,re({throwOnBadSyncType:!0},ie,{sync:!1}))}},{key:"parse",value:function(E,U,G){return G=re({},this.options,{},G,{parse:!0}),this.revive(JSON.parse(E,U),G)}},{key:"parseSync",value:function(E,U,G){return this.parse(E,U,re({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"parseAsync",value:function(E,U,G){return this.parse(E,U,re({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"specialTypeNames",value:function(E,U){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G.returnTypeNames=!0,this.encapsulate(E,U,G)}},{key:"rootTypeName",value:function(E,U){var G=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G.iterateNone=!0,this.encapsulate(E,U,G)}},{key:"encapsulate",value:function(E,U,G){G=re({sync:!0},this.options,{},G);var ie=G,Ee=ie.sync,Ie=this,ce={},yt=[],xt=[],Bt=[],Lt="cyclic"in G?G.cyclic:!0,Kt=G,dt=Kt.encapsulateObserver,kt=qe("",E,Lt,U||{},Bt);function Et(fe){var s=Object.values(ce);if(G.iterateNone)return s.length?s[0]:K.getJSONType(fe);if(s.length){if(G.returnTypeNames)return Ye(new Set(s));!fe||!B(fe)||Tt.call(fe,"$types")?fe={$:fe,$types:{$:ce}}:fe.$types=ce}else Se(fe)&&Tt.call(fe,"$types")&&(fe={$:fe,$types:!0});return G.returnTypeNames?!1:fe}function nt(fe,s){return De.apply(this,arguments)}function De(){return De=Y(regeneratorRuntime.mark(function fe(s,o){var u;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Promise.all(o.map(function(k){return k[1].p}));case 2:return u=g.sent,g.next=5,Promise.all(u.map(function(){var k=Y(regeneratorRuntime.mark(function W(ae){var ee,D,we,Te,Le,Ke,Ce,ze,We,de,rt,ue,J,Q;return regeneratorRuntime.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:if(ee=[],D=o.splice(0,1),we=le(D,1),Te=we[0],Le=le(Te,7),Ke=Le[0],Ce=Le[2],ze=Le[3],We=Le[4],de=Le[5],rt=Le[6],ue=qe(Ke,ae,Ce,ze,ee,!0,rt),J=M(ue,oe),!(Ke&&J)){pe.next=11;break}return pe.next=8,ue.p;case 8:return Q=pe.sent,We[de]=Q,pe.abrupt("return",nt(s,ee));case 11:return Ke?We[de]=ue:J?s=ue.p:s=ue,pe.abrupt("return",nt(s,ee));case 13:case"end":return pe.stop()}},W)}));return function(W){return k.apply(this,arguments)}}()));case 5:return g.abrupt("return",s);case 6:case"end":return g.stop()}},fe)})),De.apply(this,arguments)}function Be(fe,s,o){Object.assign(fe,s);var u=gt.map(function(h){var g=fe[h];return delete fe[h],g});o(),gt.forEach(function(h,g){fe[h]=u[g]})}function qe(fe,s,o,u,h,g,k){var W,ae={},ee=N(s),D=dt?function(J){var Q=k||u.type||K.getJSONType(s);dt(Object.assign(J||ae,{keypath:fe,value:s,cyclic:o,stateObj:u,promisesData:h,resolvingTypesonPromise:g,awaitingTypesonPromise:M(s,oe)},{type:Q}))}:null;if(["string","boolean","number","undefined"].includes(ee))return s===void 0||ee==="number"&&(isNaN(s)||s===-1/0||s===1/0)?(u.replaced?W=s:W=Xe(fe,s,u,h,!1,g,D),W!==s&&(ae={replaced:W})):W=s,D&&D(),W;if(s===null)return D&&D(),s;if(o&&!u.iterateIn&&!u.iterateUnsetNumeric&&s&&N(s)==="object"){var we=yt.indexOf(s);if(we<0)o===!0&&(yt.push(s),xt.push(fe));else return ce[fe]="#",D&&D({cyclicKeypath:xt[we]}),"#"+xt[we]}var Te=B(s),Le=Qe(s),Ke=(Te||Le)&&(!Ie.plainObjectReplacers.length||u.replaced)||u.iterateIn?s:Xe(fe,s,u,h,Te||Le,null,D),Ce;if(Ke!==s?(W=Ke,ae={replaced:Ke}):fe===""&&M(s,oe)?(h.push([fe,s,o,u,void 0,void 0,u.type]),W=s):Le&&u.iterateIn!=="object"||u.iterateIn==="array"?(Ce=new Array(s.length),ae={clone:Ce}):!["function","symbol"].includes(N(s))&&!("toJSON"in s)&&!M(s,oe)&&!M(s,Promise)&&!M(s,ArrayBuffer)||Te||u.iterateIn==="object"?(Ce={},u.addLength&&(Ce.length=s.length),ae={clone:Ce}):W=s,D&&D(),G.iterateNone)return Ce||W;if(!Ce)return W;if(u.iterateIn){var ze=function(Q){var ne={ownKeys:Tt.call(s,Q)};Be(u,ne,function(){var pe=fe+(fe?".":"")+Fe(Q),_e=qe(pe,s[Q],!!o,u,h,g);M(_e,oe)?h.push([pe,_e,!!o,u,Ce,Q,u.type]):_e!==void 0&&(Ce[Q]=_e)})};for(var We in s)ze(We);D&&D({endIterateIn:!0,end:!0})}else je(s).forEach(function(J){var Q=fe+(fe?".":"")+Fe(J),ne={ownKeys:!0};Be(u,ne,function(){var pe=qe(Q,s[J],!!o,u,h,g);M(pe,oe)?h.push([Q,pe,!!o,u,Ce,J,u.type]):pe!==void 0&&(Ce[J]=pe)})}),D&&D({endIterateOwn:!0,end:!0});if(u.iterateUnsetNumeric){for(var de=s.length,rt=function(Q){if(!(Q in s)){var ne=fe+(fe?".":"")+Q,pe={ownKeys:!1};Be(u,pe,function(){var _e=qe(ne,void 0,!!o,u,h,g);M(_e,oe)?h.push([ne,_e,!!o,u,Ce,Q,u.type]):_e!==void 0&&(Ce[Q]=_e)})}},ue=0;ue<de;ue++)rt(ue);D&&D({endIterateUnsetNumeric:!0,end:!0})}return Ce}function Xe(fe,s,o,u,h,g,k){for(var W=h?Ie.plainObjectReplacers:Ie.nonplainObjectReplacers,ae=W.length;ae--;){var ee=W[ae];if(ee.test(s,o)){var D=ee.type;if(Ie.revivers[D]){var we=ce[fe];ce[fe]=we?[D].concat(we):D}if(Object.assign(o,{type:D,replaced:!0}),(Ee||!ee.replaceAsync)&&!ee.replace)return k&&k({typeDetected:!0}),qe(fe,s,Lt&&"readonly",o,u,g,D);k&&k({replacing:!0});var Te=Ee||!ee.replaceAsync?"replace":"replaceAsync";return qe(fe,ee[Te](s,o),Lt&&"readonly",o,u,g,D)}}return s}return Bt.length?Ee&&G.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(nt(kt,Bt)).then(Et):!Ee&&G.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():G.stringification&&Ee?[Et(kt)]:Ee?Et(kt):Promise.resolve(Et(kt))}},{key:"encapsulateSync",value:function(E,U,G){return this.encapsulate(E,U,re({throwOnBadSyncType:!0},G,{sync:!0}))}},{key:"encapsulateAsync",value:function(E,U,G){return this.encapsulate(E,U,re({throwOnBadSyncType:!0},G,{sync:!1}))}},{key:"revive",value:function(E,U){var G=E&&E.$types;if(!G)return E;if(G===!0)return E.$;U=re({sync:!0},this.options,{},U);var ie=U,Ee=ie.sync,Ie=[],ce={},yt=!0;G.$&&B(G.$)&&(E=E.$,G=G.$,yt=!1);var xt=this;function Bt(De,Be){var qe=xt.revivers[De]||[],Xe=le(qe,1),fe=Xe[0];if(!fe)throw new Error("Unregistered type: "+De);return Ee&&!("revive"in fe)?Be:fe[Ee&&fe.revive?"revive":!Ee&&fe.reviveAsync?"reviveAsync":"revive"](Be,ce)}function Lt(){var De=[];if(Object.entries(G).forEach(function(Be){var qe=le(Be,2),Xe=qe[0],fe=qe[1];fe!=="#"&&[].concat(fe).forEach(function(s){var o=xt.revivers[s]||[null,{}],u=le(o,2),h=u[1].plain;h&&(De.push({keypath:Xe,type:s}),delete G[Xe])})}),!!De.length)return De.sort(me).reduce(function Be(qe,Xe){var fe=Xe.keypath,s=Xe.type;if(P(qe))return qe.then(function(h){return Be(h,{keypath:fe,type:s})});var o=ut(E,fe);if(o=Bt(s,o),M(o,oe))return o.then(function(h){var g=st(E,fe,h);g===h&&(E=g)});var u=st(E,fe,o);u===o&&(E=u)},void 0)}var Kt=[];function dt(De,Be,qe,Xe,fe){if(!(yt&&De==="$types")){var s=G[De],o=Qe(Be);if(o||B(Be)){var u=o?new Array(Be.length):{};for(je(Be).forEach(function(we){var Te=dt(De+(De?".":"")+Fe(we),Be[we],qe||u,u,we),Le=function(Ce){return M(Ce,lt)?u[we]=void 0:Ce!==void 0&&(u[we]=Ce),Ce};M(Te,oe)?Kt.push(Te.then(function(Ke){return Le(Ke)})):Le(Te)}),Be=u;Ie.length;){var h=le(Ie[0],4),g=h[0],k=h[1],W=h[2],ae=h[3],ee=ut(g,k);if(ee!==void 0)W[ae]=ee;else break;Ie.splice(0,1)}}if(!s)return Be;if(s==="#"){var D=ut(qe,Be.slice(1));return D===void 0&&Ie.push([qe,Be.slice(1),Xe,fe]),D}return[].concat(s).reduce(function we(Te,Le){return M(Te,oe)?Te.then(function(Ke){return we(Ke,Le)}):Bt(Le,Te)},Be)}}function kt(De){return M(De,lt)?void 0:De}var Et=Lt(),nt;return M(Et,oe)?nt=Et.then(function(){return E}):(nt=dt("",E,null),Kt.length&&(nt=oe.resolve(nt).then(function(De){return oe.all([De].concat(Kt))}).then(function(De){var Be=le(De,1),qe=Be[0];return qe}))),P(nt)?Ee&&U.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():M(nt,oe)?nt.p.then(kt):nt:!Ee&&U.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():Ee?kt(nt):Promise.resolve(kt(nt))}},{key:"reviveSync",value:function(E,U){return this.revive(E,re({throwOnBadSyncType:!0},U,{sync:!0}))}},{key:"reviveAsync",value:function(E,U){return this.revive(E,re({throwOnBadSyncType:!0},U,{sync:!1}))}},{key:"register",value:function(E,U){return U=U||{},[].concat(E).forEach(function G(ie){var Ee=this;if(Qe(ie))return ie.map(function(Ie){return G.call(Ee,Ie)});ie&&je(ie).forEach(function(Ie){if(Ie==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(K.JSON_TYPES.includes(Ie))throw new TypeError("Plain JSON object types are reserved as type names");var ce=ie[Ie],yt=ce&&ce.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,xt=yt.filter(function(qe){return qe.type===Ie});if(xt.length&&(yt.splice(yt.indexOf(xt[0]),1),delete this.revivers[Ie],delete this.types[Ie]),typeof ce=="function"){var Bt=ce;ce={test:function(Xe){return Xe&&Xe.constructor===Bt},replace:function(Xe){return re({},Xe)},revive:function(Xe){return Object.assign(Object.create(Bt.prototype),Xe)}}}else if(Qe(ce)){var Lt=ce,Kt=le(Lt,3),dt=Kt[0],kt=Kt[1],Et=Kt[2];ce={test:dt,replace:kt,revive:Et}}if(!(!ce||!ce.test)){var nt={type:Ie,test:ce.test.bind(ce)};ce.replace&&(nt.replace=ce.replace.bind(ce)),ce.replaceAsync&&(nt.replaceAsync=ce.replaceAsync.bind(ce));var De=typeof U.fallback=="number"?U.fallback:U.fallback?0:1/0;if(ce.testPlainObjects?this.plainObjectReplacers.splice(De,0,nt):this.nonplainObjectReplacers.splice(De,0,nt),ce.revive||ce.reviveAsync){var Be={};ce.revive&&(Be.revive=ce.revive.bind(ce)),ce.reviveAsync&&(Be.reviveAsync=ce.reviveAsync.bind(ce)),this.revivers[Ie]=[Be,{plain:ce.testPlainObjects}]}this.types[Ie]=ce}},this)},this),this}}]),K}(),lt=function K(){C(this,K)};return lt.__typeson__type__="TypesonUndefined",$e.Undefined=lt,$e.Promise=oe,$e.isThenable=P,$e.toStringTag=l,$e.hasConstructorOf=M,$e.isObject=Se,$e.isPlainObject=B,$e.isUserObject=Oe,$e.escapeKeyPathComponent=Fe,$e.unescapeKeyPathComponent=Ge,$e.getByKeyPath=ut,$e.getJSONType=at,$e.JSON_TYPES=["null","boolean","number","string","array","object"],$e})}),xi=wr(function(q,V){(function(N,j){q.exports=j()})(br,function(){function N(s){return(N=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(s)}function j(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function Y(s,o){for(var u=0;u<o.length;u++){var h=o[u];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(s,h.key,h)}}function C(s,o,u){return o in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,s}function w(s,o){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(s);o&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable})),u.push.apply(u,h)}return u}function H(s){return function(u){if(Array.isArray(u))return se(u)}(s)||function(u){if(typeof Symbol<"u"&&Symbol.iterator in Object(u))return Array.from(u)}(s)||function(u,h){if(u){if(typeof u=="string")return se(u,h);var g=Object.prototype.toString.call(u).slice(8,-1);if(g==="Object"&&u.constructor&&(g=u.constructor.name),g==="Map"||g==="Set")return Array.from(u);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return se(u,h)}}(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function se(s,o){(o==null||o>s.length)&&(o=s.length);for(var u=0,h=new Array(o);u<o;u++)h[u]=s[u];return h}function T(s){return(T=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u})(s)}function re(s,o){if(!(s instanceof o))throw new TypeError("Cannot call a class as a function")}function le(s,o){for(var u=0;u<o.length;u++){var h=o[u];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(s,h.key,h)}}function Ye(s,o,u){return o in s?Object.defineProperty(s,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):s[o]=u,s}function ot(s,o){var u=Object.keys(s);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(s);o&&(h=h.filter(function(g){return Object.getOwnPropertyDescriptor(s,g).enumerable})),u.push.apply(u,h)}return u}function ve(s){for(var o=1;o<arguments.length;o++){var u=arguments[o]!=null?arguments[o]:{};o%2?ot(Object(u),!0).forEach(function(h){Ye(s,h,u[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(u)):ot(Object(u)).forEach(function(h){Object.defineProperty(s,h,Object.getOwnPropertyDescriptor(u,h))})}return s}function be(s,o){return function(h){if(Array.isArray(h))return h}(s)||function(h,g){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(h)))){var k=[],W=!0,ae=!1,ee=void 0;try{for(var D,we=h[Symbol.iterator]();!(W=(D=we.next()).done)&&(k.push(D.value),!g||k.length!==g);W=!0);}catch(Te){ae=!0,ee=Te}finally{try{W||we.return==null||we.return()}finally{if(ae)throw ee}}return k}}(s,o)||mt(s,o)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Ue(s){return function(u){if(Array.isArray(u))return Ze(u)}(s)||function(u){if(typeof Symbol<"u"&&Symbol.iterator in Object(u))return Array.from(u)}(s)||mt(s)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function mt(s,o){if(s){if(typeof s=="string")return Ze(s,o);var u=Object.prototype.toString.call(s).slice(8,-1);return u==="Object"&&s.constructor&&(u=s.constructor.name),u==="Map"||u==="Set"?Array.from(s):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?Ze(s,o):void 0}}function Ze(s,o){(o==null||o>s.length)&&(o=s.length);for(var u=0,h=new Array(o);u<o;u++)h[u]=s[u];return h}var oe=function s(o){re(this,s),this.p=new Promise(o)};oe.__typeson__type__="TypesonPromise",typeof Symbol<"u"&&(oe.prototype[Symbol.toStringTag]="TypesonPromise"),oe.prototype.then=function(s,o){var u=this;return new oe(function(h,g){u.p.then(function(k){h(s?s(k):k)}).catch(function(k){return o?o(k):Promise.reject(k)}).then(h,g)})},oe.prototype.catch=function(s){return this.then(null,s)},oe.resolve=function(s){return new oe(function(o){o(s)})},oe.reject=function(s){return new oe(function(o,u){u(s)})},["all","race"].forEach(function(s){oe[s]=function(o){return new oe(function(u,h){Promise[s](o.map(function(g){return g&&g.constructor&&g.constructor.__typeson__type__==="TypesonPromise"?g.p:g})).then(u,h)})}});var ct={}.toString,he={}.hasOwnProperty,Ae=Object.getPrototypeOf,ge=he.toString;function bt(s,o){return B(s)&&typeof s.then=="function"&&(!o||typeof s.catch=="function")}function P(s){return ct.call(s).slice(8,-1)}function l(s,o){if(!s||T(s)!=="object")return!1;var u=Ae(s);if(!u)return o===null;var h=he.call(u,"constructor")&&u.constructor;return typeof h!="function"?o===null:o===h||o!==null&&ge.call(h)===ge.call(o)||typeof o=="function"&&typeof h.__typeson__type__=="string"&&h.__typeson__type__===o.__typeson__type__}function M(s){return!(!s||P(s)!=="Object")&&(!Ae(s)||l(s,Object))}function B(s){return s&&T(s)==="object"}function Oe(s){return s.replace(/~/g,"~0").replace(/\./g,"~1")}function Se(s){return s.replace(/~1/g,".").replace(/~0/g,"~")}function Fe(s,o){if(o==="")return s;var u=o.indexOf(".");if(u>-1){var h=s[Se(o.slice(0,u))];return h===void 0?void 0:Fe(h,o.slice(u+1))}return s[Se(o)]}function Ge(s,o,u){if(o==="")return u;var h=o.indexOf(".");return h>-1?Ge(s[Se(o.slice(0,h))],o.slice(h+1),u):(s[Se(o)]=u,s)}function ut(s,o,u){return s&&s.then||(s=Promise.resolve(s)),o?s.then(o):s}var st=Object.keys,at=Array.isArray,je={}.hasOwnProperty,Qe=["type","replaced","iterateIn","iterateUnsetNumeric"];function Tt(s){return function(){for(var o=[],u=0;u<arguments.length;u++)o[u]=arguments[u];try{return Promise.resolve(s.apply(this,o))}catch(h){return Promise.reject(h)}}}function gt(s,o){if(s.keypath==="")return-1;var u=s.keypath.match(/\./g)||0,h=o.keypath.match(/\./g)||0;return u&&(u=u.length),h&&(h=h.length),u>h?-1:u<h?1:s.keypath<o.keypath?-1:s.keypath>o.keypath}var me=function(){function s(o){re(this,s),this.options=o,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(u,h,g){return h&&le(u.prototype,h),u}(s,[{key:"stringify",value:function(u,h,g,k){k=ve(ve(ve({},this.options),k),{},{stringification:!0});var W=this.encapsulate(u,null,k);return at(W)?JSON.stringify(W[0],h,g):W.then(function(ae){return JSON.stringify(ae,h,g)})}},{key:"stringifySync",value:function(u,h,g,k){return this.stringify(u,h,g,ve(ve({throwOnBadSyncType:!0},k),{},{sync:!0}))}},{key:"stringifyAsync",value:function(u,h,g,k){return this.stringify(u,h,g,ve(ve({throwOnBadSyncType:!0},k),{},{sync:!1}))}},{key:"parse",value:function(u,h,g){return g=ve(ve(ve({},this.options),g),{},{parse:!0}),this.revive(JSON.parse(u,h),g)}},{key:"parseSync",value:function(u,h,g){return this.parse(u,h,ve(ve({throwOnBadSyncType:!0},g),{},{sync:!0}))}},{key:"parseAsync",value:function(u,h,g){return this.parse(u,h,ve(ve({throwOnBadSyncType:!0},g),{},{sync:!1}))}},{key:"specialTypeNames",value:function(u,h){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return g.returnTypeNames=!0,this.encapsulate(u,h,g)}},{key:"rootTypeName",value:function(u,h){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return g.iterateNone=!0,this.encapsulate(u,h,g)}},{key:"encapsulate",value:function(u,h,g){var k=Tt(function(ue,J){return ut(Promise.all(J.map(function(Q){return Q[1].p})),function(Q){return ut(Promise.all(Q.map(Tt(function(ne){var pe=!1,_e=[],wt=be(J.splice(0,1),1),et=be(wt[0],7),Pt=et[0],ft=et[2],Re=et[3],pt=et[4],Je=et[5],Rt=et[6],it=de(Pt,ne,ft,Re,_e,!0,Rt),Ft=l(it,oe);return function(sn,Qt){var He=sn();return He&&He.then?He.then(Qt):Qt(He)}(function(){if(Pt&&Ft)return ut(it.p,function(vt){return pt[Je]=vt,pe=!0,k(ue,_e)})},function(vt){return pe?vt:(Pt?pt[Je]=it:ue=Ft?it.p:it,k(ue,_e))})}))),function(){return ue})})}),W=(g=ve(ve({sync:!0},this.options),g)).sync,ae=this,ee={},D=[],we=[],Te=[],Le=!("cyclic"in g)||g.cyclic,Ke=g.encapsulateObserver,Ce=de("",u,Le,h||{},Te);function ze(ue){var J=Object.values(ee);if(g.iterateNone)return J.length?J[0]:s.getJSONType(ue);if(J.length){if(g.returnTypeNames)return Ue(new Set(J));ue&&M(ue)&&!je.call(ue,"$types")?ue.$types=ee:ue={$:ue,$types:{$:ee}}}else B(ue)&&je.call(ue,"$types")&&(ue={$:ue,$types:!0});return!g.returnTypeNames&&ue}function We(ue,J,Q){Object.assign(ue,J);var ne=Qe.map(function(pe){var _e=ue[pe];return delete ue[pe],_e});Q(),Qe.forEach(function(pe,_e){ue[pe]=ne[_e]})}function de(ue,J,Q,ne,pe,_e,wt){var et,Pt={},ft=T(J),Re=Ke?function(_t){var Ot=wt||ne.type||s.getJSONType(J);Ke(Object.assign(_t||Pt,{keypath:ue,value:J,cyclic:Q,stateObj:ne,promisesData:pe,resolvingTypesonPromise:_e,awaitingTypesonPromise:l(J,oe)},{type:Ot}))}:null;if(["string","boolean","number","undefined"].includes(ft))return J===void 0||Number.isNaN(J)||J===Number.NEGATIVE_INFINITY||J===Number.POSITIVE_INFINITY?(et=ne.replaced?J:rt(ue,J,ne,pe,!1,_e,Re))!==J&&(Pt={replaced:et}):et=J,Re&&Re(),et;if(J===null)return Re&&Re(),J;if(Q&&!ne.iterateIn&&!ne.iterateUnsetNumeric&&J&&T(J)==="object"){var pt=D.indexOf(J);if(!(pt<0))return ee[ue]="#",Re&&Re({cyclicKeypath:we[pt]}),"#"+we[pt];Q===!0&&(D.push(J),we.push(ue))}var Je,Rt=M(J),it=at(J),Ft=(Rt||it)&&(!ae.plainObjectReplacers.length||ne.replaced)||ne.iterateIn?J:rt(ue,J,ne,pe,Rt||it,null,Re);if(Ft!==J?(et=Ft,Pt={replaced:Ft}):ue===""&&l(J,oe)?(pe.push([ue,J,Q,ne,void 0,void 0,ne.type]),et=J):it&&ne.iterateIn!=="object"||ne.iterateIn==="array"?(Je=new Array(J.length),Pt={clone:Je}):(["function","symbol"].includes(T(J))||"toJSON"in J||l(J,oe)||l(J,Promise)||l(J,ArrayBuffer))&&!Rt&&ne.iterateIn!=="object"?et=J:(Je={},ne.addLength&&(Je.length=J.length),Pt={clone:Je}),Re&&Re(),g.iterateNone)return Je||et;if(!Je)return et;if(ne.iterateIn){var vt=function(Ot){var Nt={ownKeys:je.call(J,Ot)};We(ne,Nt,function(){var qt=ue+(ue?".":"")+Oe(Ot),Xt=de(qt,J[Ot],!!Q,ne,pe,_e);l(Xt,oe)?pe.push([qt,Xt,!!Q,ne,Je,Ot,ne.type]):Xt!==void 0&&(Je[Ot]=Xt)})};for(var sn in J)vt(sn);Re&&Re({endIterateIn:!0,end:!0})}else st(J).forEach(function(_t){var Ot=ue+(ue?".":"")+Oe(_t);We(ne,{ownKeys:!0},function(){var Nt=de(Ot,J[_t],!!Q,ne,pe,_e);l(Nt,oe)?pe.push([Ot,Nt,!!Q,ne,Je,_t,ne.type]):Nt!==void 0&&(Je[_t]=Nt)})}),Re&&Re({endIterateOwn:!0,end:!0});if(ne.iterateUnsetNumeric){for(var Qt=J.length,He=function(Ot){if(!(Ot in J)){var Nt=ue+(ue?".":"")+Ot;We(ne,{ownKeys:!1},function(){var qt=de(Nt,void 0,!!Q,ne,pe,_e);l(qt,oe)?pe.push([Nt,qt,!!Q,ne,Je,Ot,ne.type]):qt!==void 0&&(Je[Ot]=qt)})}},$t=0;$t<Qt;$t++)He($t);Re&&Re({endIterateUnsetNumeric:!0,end:!0})}return Je}function rt(ue,J,Q,ne,pe,_e,wt){for(var et=pe?ae.plainObjectReplacers:ae.nonplainObjectReplacers,Pt=et.length;Pt--;){var ft=et[Pt];if(ft.test(J,Q)){var Re=ft.type;if(ae.revivers[Re]){var pt=ee[ue];ee[ue]=pt?[Re].concat(pt):Re}return Object.assign(Q,{type:Re,replaced:!0}),!W&&ft.replaceAsync||ft.replace?(wt&&wt({replacing:!0}),de(ue,ft[W||!ft.replaceAsync?"replace":"replaceAsync"](J,Q),Le&&"readonly",Q,ne,_e,Re)):(wt&&wt({typeDetected:!0}),de(ue,J,Le&&"readonly",Q,ne,_e,Re))}}return J}return Te.length?W&&g.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(k(Ce,Te)).then(ze):!W&&g.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():g.stringification&&W?[ze(Ce)]:W?ze(Ce):Promise.resolve(ze(Ce))}},{key:"encapsulateSync",value:function(u,h,g){return this.encapsulate(u,h,ve(ve({throwOnBadSyncType:!0},g),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(u,h,g){return this.encapsulate(u,h,ve(ve({throwOnBadSyncType:!0},g),{},{sync:!1}))}},{key:"revive",value:function(u,h){var g=u&&u.$types;if(!g)return u;if(g===!0)return u.$;var k=(h=ve(ve({sync:!0},this.options),h)).sync,W=[],ae={},ee=!0;g.$&&M(g.$)&&(u=u.$,g=g.$,ee=!1);var D=this;function we(ze,We){var de=be(D.revivers[ze]||[],1)[0];if(!de)throw new Error("Unregistered type: "+ze);return k&&!("revive"in de)?We:de[k&&de.revive?"revive":!k&&de.reviveAsync?"reviveAsync":"revive"](We,ae)}var Te=[];function Le(ze){return l(ze,$e)?void 0:ze}var Ke,Ce=function(){var We=[];if(Object.entries(g).forEach(function(de){var rt=be(de,2),ue=rt[0],J=rt[1];J!=="#"&&[].concat(J).forEach(function(Q){be(D.revivers[Q]||[null,{}],2)[1].plain&&(We.push({keypath:ue,type:Q}),delete g[ue])})}),We.length)return We.sort(gt).reduce(function de(rt,ue){var J=ue.keypath,Q=ue.type;if(bt(rt))return rt.then(function(_e){return de(_e,{keypath:J,type:Q})});var ne=Fe(u,J);if(l(ne=we(Q,ne),oe))return ne.then(function(_e){var wt=Ge(u,J,_e);wt===_e&&(u=wt)});var pe=Ge(u,J,ne);pe===ne&&(u=pe)},void 0)}();return l(Ce,oe)?Ke=Ce.then(function(){return u}):(Ke=function ze(We,de,rt,ue,J){if(!ee||We!=="$types"){var Q=g[We],ne=at(de);if(ne||M(de)){var pe=ne?new Array(de.length):{};for(st(de).forEach(function(Je){var Rt=ze(We+(We?".":"")+Oe(Je),de[Je],rt||pe,pe,Je),it=function(vt){return l(vt,$e)?pe[Je]=void 0:vt!==void 0&&(pe[Je]=vt),vt};l(Rt,oe)?Te.push(Rt.then(function(Ft){return it(Ft)})):it(Rt)}),de=pe;W.length;){var _e=be(W[0],4),wt=_e[0],et=_e[1],Pt=_e[2],ft=_e[3],Re=Fe(wt,et);if(Re===void 0)break;Pt[ft]=Re,W.splice(0,1)}}if(!Q)return de;if(Q==="#"){var pt=Fe(rt,de.slice(1));return pt===void 0&&W.push([rt,de.slice(1),ue,J]),pt}return[].concat(Q).reduce(function Je(Rt,it){return l(Rt,oe)?Rt.then(function(Ft){return Je(Ft,it)}):we(it,Rt)},de)}}("",u,null),Te.length&&(Ke=oe.resolve(Ke).then(function(ze){return oe.all([ze].concat(Te))}).then(function(ze){return be(ze,1)[0]}))),bt(Ke)?k&&h.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():l(Ke,oe)?Ke.p.then(Le):Ke:!k&&h.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():k?Le(Ke):Promise.resolve(Le(Ke))}},{key:"reviveSync",value:function(u,h){return this.revive(u,ve(ve({throwOnBadSyncType:!0},h),{},{sync:!0}))}},{key:"reviveAsync",value:function(u,h){return this.revive(u,ve(ve({throwOnBadSyncType:!0},h),{},{sync:!1}))}},{key:"register",value:function(u,h){return h=h||{},[].concat(u).forEach(function g(k){var W=this;if(at(k))return k.map(function(ae){return g.call(W,ae)});k&&st(k).forEach(function(ae){if(ae==="#")throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(s.JSON_TYPES.includes(ae))throw new TypeError("Plain JSON object types are reserved as type names");var ee=k[ae],D=ee&&ee.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,we=D.filter(function(We){return We.type===ae});if(we.length&&(D.splice(D.indexOf(we[0]),1),delete this.revivers[ae],delete this.types[ae]),typeof ee=="function"){var Te=ee;ee={test:function(de){return de&&de.constructor===Te},replace:function(de){return ve({},de)},revive:function(de){return Object.assign(Object.create(Te.prototype),de)}}}else if(at(ee)){var Le=be(ee,3);ee={test:Le[0],replace:Le[1],revive:Le[2]}}if(ee&&ee.test){var Ke={type:ae,test:ee.test.bind(ee)};ee.replace&&(Ke.replace=ee.replace.bind(ee)),ee.replaceAsync&&(Ke.replaceAsync=ee.replaceAsync.bind(ee));var Ce=typeof h.fallback=="number"?h.fallback:h.fallback?0:Number.POSITIVE_INFINITY;if(ee.testPlainObjects?this.plainObjectReplacers.splice(Ce,0,Ke):this.nonplainObjectReplacers.splice(Ce,0,Ke),ee.revive||ee.reviveAsync){var ze={};ee.revive&&(ze.revive=ee.revive.bind(ee)),ee.reviveAsync&&(ze.reviveAsync=ee.reviveAsync.bind(ee)),this.revivers[ae]=[ze,{plain:ee.testPlainObjects}]}this.types[ae]=ee}},this)},this),this}}]),s}(),$e=function s(){re(this,s)};$e.__typeson__type__="TypesonUndefined",me.Undefined=$e,me.Promise=oe,me.isThenable=bt,me.toStringTag=P,me.hasConstructorOf=l,me.isObject=B,me.isPlainObject=M,me.isUserObject=function s(o){if(!o||P(o)!=="Object")return!1;var u=Ae(o);return!u||l(o,Object)||s(u)},me.escapeKeyPathComponent=Oe,me.unescapeKeyPathComponent=Se,me.getByKeyPath=Fe,me.getJSONType=function(o){return o===null?"null":Array.isArray(o)?"array":T(o)},me.JSON_TYPES=["null","boolean","number","string","array","object"];for(var lt={userObject:{test:function(o,u){return me.isUserObject(o)},replace:function(o){return function(h){for(var g=1;g<arguments.length;g++){var k=arguments[g]!=null?arguments[g]:{};g%2?w(Object(k),!0).forEach(function(W){C(h,W,k[W])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(k)):w(Object(k)).forEach(function(W){Object.defineProperty(h,W,Object.getOwnPropertyDescriptor(k,W))})}return h}({},o)},revive:function(o){return o}}},K=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(o,u){return!!Array.isArray(o)&&(Object.keys(o).some(function(h){return String(Number.parseInt(h))!==h})&&(u.iterateIn="object",u.addLength=!0),!0)},replace:function(o,u){return u.iterateUnsetNumeric=!0,o},revive:function(o){if(Array.isArray(o))return o;var u=[];return Object.keys(o).forEach(function(h){var g=o[h];u[h]=g}),u}}},{sparseUndefined:{test:function(o,u){return o===void 0&&u.ownKeys===!1},replace:function(o){return 0},revive:function(o){}}}],F={undef:{test:function(o,u){return o===void 0&&(u.ownKeys||!("ownKeys"in u))},replace:function(o){return 0},revive:function(o){return new me.Undefined}}},E={StringObject:{test:function(o){return me.toStringTag(o)==="String"&&N(o)==="object"},replace:function(o){return String(o)},revive:function(o){return new String(o)}},BooleanObject:{test:function(o){return me.toStringTag(o)==="Boolean"&&N(o)==="object"},replace:function(o){return!!o},revive:function(o){return new Boolean(o)}},NumberObject:{test:function(o){return me.toStringTag(o)==="Number"&&N(o)==="object"},replace:function(o){return Number(o)},revive:function(o){return new Number(o)}}},U=[{nan:{test:function(o){return Number.isNaN(o)},replace:function(o){return"NaN"},revive:function(o){return Number.NaN}}},{infinity:{test:function(o){return o===Number.POSITIVE_INFINITY},replace:function(o){return"Infinity"},revive:function(o){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(o){return o===Number.NEGATIVE_INFINITY},replace:function(o){return"-Infinity"},revive:function(o){return Number.NEGATIVE_INFINITY}}}],G={date:{test:function(o){return me.toStringTag(o)==="Date"},replace:function(o){var u=o.getTime();return Number.isNaN(u)?"NaN":u},revive:function(o){return o==="NaN"?new Date(Number.NaN):new Date(o)}}},ie={regexp:{test:function(o){return me.toStringTag(o)==="RegExp"},replace:function(o){return{source:o.source,flags:(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":"")}},revive:function(o){var u=o.source,h=o.flags;return new RegExp(u,h)}}},Ee={map:{test:function(o){return me.toStringTag(o)==="Map"},replace:function(o){return H(o.entries())},revive:function(o){return new Map(o)}}},Ie={set:{test:function(o){return me.toStringTag(o)==="Set"},replace:function(o){return H(o.values())},revive:function(o){return new Set(o)}}},ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",yt=new Uint8Array(256),xt=0;xt<ce.length;xt++)yt[ce.charCodeAt(xt)]=xt;var Bt=function(o,u,h){h==null&&(h=o.byteLength);for(var g=new Uint8Array(o,0,h),k=g.length,W="",ae=0;ae<k;ae+=3)W+=ce[g[ae]>>2],W+=ce[(3&g[ae])<<4|g[ae+1]>>4],W+=ce[(15&g[ae+1])<<2|g[ae+2]>>6],W+=ce[63&g[ae+2]];return k%3==2?W=W.slice(0,-1)+"=":k%3==1&&(W=W.slice(0,-2)+"=="),W},Lt=function(o){var u,h,g,k,W=o.length,ae=.75*o.length,ee=0;o[o.length-1]==="="&&(ae--,o[o.length-2]==="="&&ae--);for(var D=new ArrayBuffer(ae),we=new Uint8Array(D),Te=0;Te<W;Te+=4)u=yt[o.charCodeAt(Te)],h=yt[o.charCodeAt(Te+1)],g=yt[o.charCodeAt(Te+2)],k=yt[o.charCodeAt(Te+3)],we[ee++]=u<<2|h>>4,we[ee++]=(15&h)<<4|g>>2,we[ee++]=(3&g)<<6|63&k;return D},Kt={arraybuffer:{test:function(o){return me.toStringTag(o)==="ArrayBuffer"},replace:function(o,u){u.buffers||(u.buffers=[]);var h=u.buffers.indexOf(o);return h>-1?{index:h}:(u.buffers.push(o),Bt(o))},revive:function(o,u){if(u.buffers||(u.buffers=[]),N(o)==="object")return u.buffers[o.index];var h=Lt(o);return u.buffers.push(h),h}}},dt=typeof self>"u"?br:self,kt={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(s){var o=s,u=dt[o];u&&(kt[s.toLowerCase()]={test:function(g){return me.toStringTag(g)===o},replace:function(g,k){var W=g.buffer,ae=g.byteOffset,ee=g.length;k.buffers||(k.buffers=[]);var D=k.buffers.indexOf(W);return D>-1?{index:D,byteOffset:ae,length:ee}:(k.buffers.push(W),{encoded:Bt(W),byteOffset:ae,length:ee})},revive:function(g,k){k.buffers||(k.buffers=[]);var W,ae=g.byteOffset,ee=g.length,D=g.encoded,we=g.index;return"index"in g?W=k.buffers[we]:(W=Lt(D),k.buffers.push(W)),new u(W,ae,ee)}})});var Et={dataview:{test:function(o){return me.toStringTag(o)==="DataView"},replace:function(o,u){var h=o.buffer,g=o.byteOffset,k=o.byteLength;u.buffers||(u.buffers=[]);var W=u.buffers.indexOf(h);return W>-1?{index:W,byteOffset:g,byteLength:k}:(u.buffers.push(h),{encoded:Bt(h),byteOffset:g,byteLength:k})},revive:function(o,u){u.buffers||(u.buffers=[]);var h,g=o.byteOffset,k=o.byteLength,W=o.encoded,ae=o.index;return"index"in o?h=u.buffers[ae]:(h=Lt(W),u.buffers.push(h)),new DataView(h,g,k)}}},nt={IntlCollator:{test:function(o){return me.hasConstructorOf(o,Intl.Collator)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.Collator(o.locale,o)}},IntlDateTimeFormat:{test:function(o){return me.hasConstructorOf(o,Intl.DateTimeFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.DateTimeFormat(o.locale,o)}},IntlNumberFormat:{test:function(o){return me.hasConstructorOf(o,Intl.NumberFormat)},replace:function(o){return o.resolvedOptions()},revive:function(o){return new Intl.NumberFormat(o.locale,o)}}};function De(s){for(var o=new Uint8Array(s.length),u=0;u<s.length;u++)o[u]=s.charCodeAt(u);return o.buffer}var Be={file:{test:function(o){return me.toStringTag(o)==="File"},replace:function(o){var u=new XMLHttpRequest;if(u.overrideMimeType("text/plain; charset=x-user-defined"),u.open("GET",URL.createObjectURL(o),!1),u.send(),u.status!==200&&u.status!==0)throw new Error("Bad File access: "+u.status);return{type:o.type,stringContents:u.responseText,name:o.name,lastModified:o.lastModified}},revive:function(o){var u=o.name,h=o.type,g=o.stringContents,k=o.lastModified;return new File([De(g)],u,{type:h,lastModified:k})},replaceAsync:function(o){return new me.Promise(function(u,h){var g=new FileReader;g.addEventListener("load",function(){u({type:o.type,stringContents:g.result,name:o.name,lastModified:o.lastModified})}),g.addEventListener("error",function(){h(g.error)}),g.readAsBinaryString(o)})}}},qe={bigint:{test:function(o){return typeof o=="bigint"},replace:function(o){return String(o)},revive:function(o){return BigInt(o)}}},Xe={bigintObject:{test:function(o){return N(o)==="object"&&me.hasConstructorOf(o,BigInt)},replace:function(o){return String(o)},revive:function(o){return new Object(BigInt(o))}}},fe={cryptokey:{test:function(o){return me.toStringTag(o)==="CryptoKey"&&o.extractable},replaceAsync:function(o){return new me.Promise(function(u,h){crypto.subtle.exportKey("jwk",o).catch(function(g){h(g)}).then(function(g){u({jwk:g,algorithm:o.algorithm,usages:o.usages})})})},revive:function(o){var u=o.jwk,h=o.algorithm,g=o.usages;return crypto.subtle.importKey("jwk",u,h,!0,g)}}};return[lt,F,K,E,U,G,ie,{imagedata:{test:function(o){return me.toStringTag(o)==="ImageData"},replace:function(o){return{array:H(o.data),width:o.width,height:o.height}},revive:function(o){return new ImageData(new Uint8ClampedArray(o.array),o.width,o.height)}}},{imagebitmap:{test:function(o){return me.toStringTag(o)==="ImageBitmap"||o&&o.dataset&&o.dataset.toStringTag==="ImageBitmap"},replace:function(o){var u=document.createElement("canvas");return u.getContext("2d").drawImage(o,0,0),u.toDataURL()},revive:function(o){var u=document.createElement("canvas"),h=u.getContext("2d"),g=document.createElement("img");return g.addEventListener("load",function(){h.drawImage(g,0,0)}),g.src=o,u},reviveAsync:function(o){var u=document.createElement("canvas"),h=u.getContext("2d"),g=document.createElement("img");return g.addEventListener("load",function(){h.drawImage(g,0,0)}),g.src=o,createImageBitmap(u)}}},Be,{file:Be.file,filelist:{test:function(o){return me.toStringTag(o)==="FileList"},replace:function(o){for(var u=[],h=0;h<o.length;h++)u[h]=o.item(h);return u},revive:function(o){return new(function(){function u(){j(this,u),this._files=arguments[0],this.length=this._files.length}return function(g,k,W){return k&&Y(g.prototype,k),g}(u,[{key:"item",value:function(g){return this._files[g]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),u}())(o)}}},{blob:{test:function(o){return me.toStringTag(o)==="Blob"},replace:function(o){var u=new XMLHttpRequest;if(u.overrideMimeType("text/plain; charset=x-user-defined"),u.open("GET",URL.createObjectURL(o),!1),u.send(),u.status!==200&&u.status!==0)throw new Error("Bad Blob access: "+u.status);return{type:o.type,stringContents:u.responseText}},revive:function(o){var u=o.type,h=o.stringContents;return new Blob([De(h)],{type:u})},replaceAsync:function(o){return new me.Promise(function(u,h){var g=new FileReader;g.addEventListener("load",function(){u({type:o.type,stringContents:g.result})}),g.addEventListener("error",function(){h(g.error)}),g.readAsBinaryString(o)})}}}].concat(typeof Map=="function"?Ee:[],typeof Set=="function"?Ie:[],typeof ArrayBuffer=="function"?Kt:[],typeof Uint8Array=="function"?kt:[],typeof DataView=="function"?Et:[],typeof Intl<"u"?nt:[],typeof crypto<"u"?fe:[],typeof BigInt<"u"?[qe,Xe]:[])})}),pn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_n=new Uint8Array(256);for(var Ln=0;Ln<pn.length;Ln++)_n[pn.codePointAt(Ln)]=Ln;var gr=function(V,N,j){j==null&&(j=V.byteLength);for(var Y=new Uint8Array(V,0,j),C=Y.length,w="",H=0;H<C;H+=3)w+=pn[Y[H]>>2],w+=pn[(Y[H]&3)<<4|Y[H+1]>>4],w+=pn[(Y[H+1]&15)<<2|Y[H+2]>>6],w+=pn[Y[H+2]&63];return C%3===2?w=w.slice(0,-1)+"=":C%3===1&&(w=w.slice(0,-2)+"=="),w},Xr=function(V){var N=V.length,j=V.length*.75,Y=0,C,w,H,se;V[V.length-1]==="="&&(j--,V[V.length-2]==="="&&j--);for(var T=new ArrayBuffer(j),re=new Uint8Array(T),le=0;le<N;le+=4)C=_n[V.codePointAt(le)],w=_n[V.codePointAt(le+1)],H=_n[V.codePointAt(le+2)],se=_n[V.codePointAt(le+3)],re[Y++]=C<<2|w>>4,re[Y++]=(w&15)<<4|H>>2,re[Y++]=(H&3)<<6|se&63;return T},ki=typeof self>"u"?global:self,Zr={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach(function(q){var V=q,N=ki[V];N&&(Zr[q.toLowerCase()+"2"]={test:function(j){return qn.toStringTag(j)===V},replace:function(j){var Y=j.buffer,C=j.byteOffset,w=j.length;return{buffer:Y,byteOffset:C,length:w}},revive:function(j){var Y=j.buffer,C=j.byteOffset,w=j.length;return new N(Y,C,w)}})});var Pi={arraybuffer:{test:function(q){return qn.toStringTag(q)==="ArrayBuffer"},replace:function(q){return gr(q,0,q.byteLength)},revive:function(q){var V=Xr(q);return V}}},Vt=new qn().register(xi),Ni="FileReaderSync"in self,Un=[],vr=0;Vt.register([Pi,Zr,{blob2:{test:function(q){return qn.toStringTag(q)==="Blob"},replace:function(q){if(q.isClosed)throw new Error("The Blob is closed");if(Ni){var V=Qr(q,"binary"),N=gr(V,0,V.byteLength);return{type:q.type,data:N}}else{Un.push(q);var j={type:q.type,data:{start:vr,end:vr+q.size}};return vr+=q.size,j}},finalize:function(q,V){q.data=gr(V,0,V.byteLength)},revive:function(q){var V=q.type,N=q.data;return new Blob([Xr(N)],{type:V})}}}]);Vt.mustFinalize=function(){return Un.length>0};Vt.finalize=function(q){return nn(void 0,void 0,void 0,function(){var V,N,j,Y,C,w,H,se,T,re;return Yt(this,function(le){switch(le.label){case 0:return[4,Hr(new Blob(Un),"binary")];case 1:if(V=le.sent(),q){for(N=0,j=q;N<j.length;N++)if(Y=j[N],Y.$types){C=Y.$types,w=C.$,w&&(C=C.$);for(H in C)se=C[H],T=Vt.types[se],T&&T.finalize&&(re=At.getByKeyPath(Y,w?"$."+H:H),T.finalize(re,V.slice(re.start,re.end)))}}return Un=[],[2]}})})};var ji=2e3;function Ci(q,V){return nn(this,void 0,void 0,function(){function N(){return nn(this,void 0,void 0,function(){var le,Ye,ot,ve,be,Ue,mt,Ze,oe,ct;return Yt(this,function(he){switch(he.label){case 0:return[4,Promise.all(Y.map(function(Ae){return Ae.count()}))];case 1:le=he.sent(),le.forEach(function(Ae,ge){return w[ge].rowCount=Ae}),re.totalRows=le.reduce(function(Ae,ge){return Ae+ge}),Ye=JSON.stringify(se,void 0,H?2:void 0),ot=Ye.lastIndexOf("]"),ve=Ye.substring(0,ot),C.push(ve),be=V.filter,Ue=V.transform,mt=function(Ae){var ge,bt,P,l,M,B,Oe,Se,Fe,Ge,ut,st;return Yt(this,function(at){switch(at.label){case 0:ge=q.table(Ae),bt=ge.schema.primKey,P=!!bt.keyPath,l=V.numRowsPerChunk||ji,M=P?{tableName:ge.name,inbound:!0,rows:[]}:{tableName:ge.name,inbound:!1,rows:[]},B=JSON.stringify(M,void 0,H?2:void 0),H&&(B=B.split(`
`).join(`
    `)),Oe=B.lastIndexOf("]"),C.push(B.substring(0,Oe)),Se=null,Fe=0,Ge=!0,ut=function(){var je,Qe,Tt,gt,me,F,$e,lt,K,F;return Yt(this,function(E){switch(E.label){case 0:return T&&At.ignoreTransaction(function(){return T(re)}),je=Se==null?ge.limit(l):ge.where(":id").above(Se).limit(l),[4,je.toArray()];case 1:return Qe=E.sent(),Qe.length===0?[2,"break"]:(Se!=null&&Fe>0&&(C.push(","),H&&C.push(`
      `)),Ge=Qe.length===l,P?(Tt=be?Qe.filter(function(U){return be(Ae,U)}):Qe,gt=Ue?Tt.map(function(U){return Ue(Ae,U).value}):Tt,me=gt.map(function(U){return Vt.encapsulate(U)}),Vt.mustFinalize()?[4,At.waitFor(Vt.finalize(me))]:[3,3]):[3,4]);case 2:E.sent(),E.label=3;case 3:return F=JSON.stringify(me,void 0,H?2:void 0),H&&(F=F.split(`
`).join(`
      `)),C.push(new Blob([F.substring(1,F.length-1)])),Fe=gt.length,Se=Qe.length>0?At.getByKeyPath(Qe[Qe.length-1],bt.keyPath):null,[3,8];case 4:return[4,je.primaryKeys()];case 5:return $e=E.sent(),lt=$e.map(function(U,G){return[U,Qe[G]]}),be&&(lt=lt.filter(function(U){var G=U[0],ie=U[1];return be(Ae,ie,G)})),Ue&&(lt=lt.map(function(U){var G=U[0],ie=U[1],Ee=Ue(Ae,ie,G);return[Ee.key,Ee.value]})),K=lt.map(function(U){return Vt.encapsulate(U)}),Vt.mustFinalize()?[4,At.waitFor(Vt.finalize(K))]:[3,7];case 6:E.sent(),E.label=7;case 7:F=JSON.stringify(K,void 0,H?2:void 0),H&&(F=F.split(`
`).join(`
      `)),C.push(new Blob([F.substring(1,F.length-1)])),Fe=lt.length,Se=$e.length>0?$e[$e.length-1]:null,E.label=8;case 8:return re.completedRows+=Qe.length,[2]}})},at.label=1;case 1:return Ge?[5,ut()]:[3,3];case 2:return st=at.sent(),st==="break"?[3,3]:[3,1];case 3:return C.push(B.substr(Oe)),re.completedTables+=1,re.completedTables<re.totalTables&&C.push(","),[2]}})},Ze=0,oe=w,he.label=2;case 2:return Ze<oe.length?(ct=oe[Ze].name,[5,mt(ct)]):[3,5];case 3:he.sent(),he.label=4;case 4:return Ze++,[3,2];case 5:return C.push(Ye.substr(ot)),re.done=!0,T&&At.ignoreTransaction(function(){return T(re)}),[2]}})})}var j,Y,C,w,H,se,T,re;return Yt(this,function(le){switch(le.label){case 0:V=V||{},j=V.skipTables?V.skipTables:[],Y=q.tables.filter(function(Ye){return!j.includes(Ye.name)}),C=[],w=Y.map(function(Ye){return{name:Ye.name,schema:Ai(Ye),rowCount:0}}),H=V.prettyJson,se={formatName:"dexie",formatVersion:1,data:{databaseName:q.name,databaseVersion:q.verno,tables:w,data:[]}},T=V.progressCallback,re={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:w.length},le.label=1;case 1:return le.trys.push([1,,6,7]),V.noTransaction?[4,N()]:[3,3];case 2:return le.sent(),[3,5];case 3:return[4,q.transaction("r",q.tables,N)];case 4:le.sent(),le.label=5;case 5:return[3,7];case 6:return Vt.finalize(),[7];case 7:return[2,new Blob(C,{type:"text/json"})]}})})}var Ii=1,Bi={Stream:function(){}},Ki=wr(function(q,V){(function(N){var j=typeof process=="object"&&zr?zr:self;N.parser=function(P){return new ot(P)},N.CParser=ot,N.CStream=be,N.createStream=ve,N.MAX_BUFFER_LENGTH=10*1024*1024,N.DEBUG=j.CDEBUG==="debug",N.INFO=j.CDEBUG==="debug"||j.CDEBUG==="info",N.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var Y={textNode:void 0,numberNode:""},C=N.EVENTS.filter(function(P){return P!=="error"&&P!=="end"}),w=0,H;N.STATE={BEGIN:w++,VALUE:w++,OPEN_OBJECT:w++,CLOSE_OBJECT:w++,OPEN_ARRAY:w++,CLOSE_ARRAY:w++,TEXT_ESCAPE:w++,STRING:w++,BACKSLASH:w++,END:w++,OPEN_KEY:w++,CLOSE_KEY:w++,TRUE:w++,TRUE2:w++,TRUE3:w++,FALSE:w++,FALSE2:w++,FALSE3:w++,FALSE4:w++,NULL:w++,NULL2:w++,NULL3:w++,NUMBER_DECIMAL_POINT:w++,NUMBER_DIGIT:w++};for(var se in N.STATE)N.STATE[N.STATE[se]]=se;w=N.STATE;const T={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};Object.create||(Object.create=function(P){function l(){this.__proto__=P}return l.prototype=P,new l}),Object.getPrototypeOf||(Object.getPrototypeOf=function(P){return P.__proto__}),Object.keys||(Object.keys=function(P){var l=[];for(var M in P)P.hasOwnProperty(M)&&l.push(M);return l});function re(P){var l=Math.max(N.MAX_BUFFER_LENGTH,10),M=0;for(var B in Y){var Oe=P[B]===void 0?0:P[B].length;if(Oe>l)switch(B){case"text":closeText(P);break;default:he(P,"Max buffer length exceeded: "+B)}M=Math.max(M,Oe)}P.bufferCheckPosition=N.MAX_BUFFER_LENGTH-M+P.position}function le(P){for(var l in Y)P[l]=Y[l]}var Ye=/[\\"\n]/g;function ot(P){if(!(this instanceof ot))return new ot(P);var l=this;le(l),l.bufferCheckPosition=N.MAX_BUFFER_LENGTH,l.q=l.c=l.p="",l.opt=P||{},l.closed=l.closedRoot=l.sawRoot=!1,l.tag=l.error=null,l.state=w.BEGIN,l.stack=new Array,l.position=l.column=0,l.line=1,l.slashed=!1,l.unicodeI=0,l.unicodeS=null,l.depth=0,Ue(l,"onready")}ot.prototype={end:function(){Ae(this)},write:bt,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{H=Bi.Stream}catch{H=function(){}}function ve(P){return new be(P)}function be(P){if(!(this instanceof be))return new be(P);this._parser=new ot(P),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var l=this;H.apply(l),this._parser.onend=function(){l.emit("end")},this._parser.onerror=function(M){l.emit("error",M),l._parser.error=null},C.forEach(function(M){Object.defineProperty(l,"on"+M,{get:function(){return l._parser["on"+M]},set:function(B){if(!B)return l.removeAllListeners(M),l._parser["on"+M]=B,B;l.on(M,B)},enumerable:!0,configurable:!1})})}be.prototype=Object.create(H.prototype,{constructor:{value:be}}),be.prototype.write=function(P){P=new Buffer(P);for(var l=0;l<P.length;l++){var M=P[l];if(this.bytes_remaining>0){for(var B=0;B<this.bytes_remaining;B++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+B]=P[B];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,l=l+B-1,this._parser.write(this.string),this.emit("data",this.string);continue}if(this.bytes_remaining===0&&M>=128)if(M>=194&&M<=223&&(this.bytes_in_sequence=2),M>=224&&M<=239&&(this.bytes_in_sequence=3),M>=240&&M<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+l>P.length){for(var Oe=0;Oe<=P.length-1-l;Oe++)this.temp_buffs[this.bytes_in_sequence][Oe]=P[l+Oe];return this.bytes_remaining=l+this.bytes_in_sequence-P.length,!0}else{this.string=P.slice(l,l+this.bytes_in_sequence).toString(),l=l+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string);continue}for(var Se=l;Se<P.length&&!(P[Se]>=128);Se++);this.string=P.slice(l,Se).toString(),this._parser.write(this.string),this.emit("data",this.string),l=Se-1}},be.prototype.end=function(P){return P&&P.length&&this._parser.write(P.toString()),this._parser.end(),!0},be.prototype.on=function(P,l){var M=this;return!M._parser["on"+P]&&C.indexOf(P)!==-1&&(M._parser["on"+P]=function(){var B=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);B.splice(0,0,P),M.emit.apply(M,B)}),H.prototype.on.call(M,P,l)},be.prototype.destroy=function(){le(this._parser),this.emit("close")};function Ue(P,l,M){N.INFO&&console.log("-- emit",l,M),P[l]&&P[l](M)}function mt(P,l,M){Ze(P),Ue(P,l,M)}function Ze(P,l){P.textNode=ct(P.opt,P.textNode),P.textNode!==void 0&&Ue(P,l||"onvalue",P.textNode),P.textNode=void 0}function oe(P){P.numberNode&&Ue(P,"onvalue",parseFloat(P.numberNode)),P.numberNode=""}function ct(P,l){return l===void 0||(P.trim&&(l=l.trim()),P.normalize&&(l=l.replace(/\s+/g," "))),l}function he(P,l){return Ze(P),l+=`
Line: `+P.line+`
Column: `+P.column+`
Char: `+P.c,l=new Error(l),P.error=l,Ue(P,"onerror",l),P}function Ae(P){return(P.state!==w.VALUE||P.depth!==0)&&he(P,"Unexpected end"),Ze(P),P.c="",P.closed=!0,Ue(P,"onend"),ot.call(P,P.opt),P}function ge(P){return P===T.carriageReturn||P===T.lineFeed||P===T.space||P===T.tab}function bt(P){var l=this;if(this.error)throw this.error;if(l.closed)return he(l,"Cannot write after close. Assign an onready handler.");if(P===null)return Ae(l);var M=0,B=P.charCodeAt(0),Oe=l.p;for(N.DEBUG&&console.log("write -> ["+P+"]");B&&(Oe=B,l.c=B=P.charCodeAt(M++),Oe!==B?l.p=Oe:Oe=l.p,!!B);)switch(N.DEBUG&&console.log(M,B,N.STATE[l.state]),l.position++,B===T.lineFeed?(l.line++,l.column=0):l.column++,l.state){case w.BEGIN:B===T.openBrace?l.state=w.OPEN_OBJECT:B===T.openBracket?l.state=w.OPEN_ARRAY:ge(B)||he(l,"Non-whitespace before {[.");continue;case w.OPEN_KEY:case w.OPEN_OBJECT:if(ge(B))continue;if(l.state===w.OPEN_KEY)l.stack.push(w.CLOSE_KEY);else if(B===T.closeBrace){Ue(l,"onopenobject"),this.depth++,Ue(l,"oncloseobject"),this.depth--,l.state=l.stack.pop()||w.VALUE;continue}else l.stack.push(w.CLOSE_OBJECT);B===T.doubleQuote?l.state=w.STRING:he(l,'Malformed object key should start with "');continue;case w.CLOSE_KEY:case w.CLOSE_OBJECT:if(ge(B))continue;l.state,w.CLOSE_KEY,B===T.colon?(l.state===w.CLOSE_OBJECT?(l.stack.push(w.CLOSE_OBJECT),Ze(l,"onopenobject"),this.depth++):Ze(l,"onkey"),l.state=w.VALUE):B===T.closeBrace?(mt(l,"oncloseobject"),this.depth--,l.state=l.stack.pop()||w.VALUE):B===T.comma?(l.state===w.CLOSE_OBJECT&&l.stack.push(w.CLOSE_OBJECT),Ze(l),l.state=w.OPEN_KEY):he(l,"Bad object");continue;case w.OPEN_ARRAY:case w.VALUE:if(ge(B))continue;if(l.state===w.OPEN_ARRAY)if(Ue(l,"onopenarray"),this.depth++,l.state=w.VALUE,B===T.closeBracket){Ue(l,"onclosearray"),this.depth--,l.state=l.stack.pop()||w.VALUE;continue}else l.stack.push(w.CLOSE_ARRAY);B===T.doubleQuote?l.state=w.STRING:B===T.openBrace?l.state=w.OPEN_OBJECT:B===T.openBracket?l.state=w.OPEN_ARRAY:B===T.t?l.state=w.TRUE:B===T.f?l.state=w.FALSE:B===T.n?l.state=w.NULL:B===T.minus?l.numberNode+="-":T._0<=B&&B<=T._9?(l.numberNode+=String.fromCharCode(B),l.state=w.NUMBER_DIGIT):he(l,"Bad value");continue;case w.CLOSE_ARRAY:if(B===T.comma)l.stack.push(w.CLOSE_ARRAY),Ze(l,"onvalue"),l.state=w.VALUE;else if(B===T.closeBracket)mt(l,"onclosearray"),this.depth--,l.state=l.stack.pop()||w.VALUE;else{if(ge(B))continue;he(l,"Bad array")}continue;case w.STRING:l.textNode===void 0&&(l.textNode="");var Se=M-1,Fe=l.slashed,Ge=l.unicodeI;e:for(;;){for(N.DEBUG&&console.log(M,B,N.STATE[l.state],Fe);Ge>0;)if(l.unicodeS+=String.fromCharCode(B),B=P.charCodeAt(M++),l.position++,Ge===4?(l.textNode+=String.fromCharCode(parseInt(l.unicodeS,16)),Ge=0,Se=M-1):Ge++,!B)break e;if(B===T.doubleQuote&&!Fe){l.state=l.stack.pop()||w.VALUE,l.textNode+=P.substring(Se,M-1),l.position+=M-1-Se;break}if(B===T.backslash&&!Fe&&(Fe=!0,l.textNode+=P.substring(Se,M-1),l.position+=M-1-Se,B=P.charCodeAt(M++),l.position++,!B))break;if(Fe){if(Fe=!1,B===T.n?l.textNode+=`
`:B===T.r?l.textNode+="\r":B===T.t?l.textNode+="	":B===T.f?l.textNode+="\f":B===T.b?l.textNode+="\b":B===T.u?(Ge=1,l.unicodeS=""):l.textNode+=String.fromCharCode(B),B=P.charCodeAt(M++),l.position++,Se=M-1,B)continue;break}Ye.lastIndex=M;var ut=Ye.exec(P);if(ut===null){M=P.length+1,l.textNode+=P.substring(Se,M-1),l.position+=M-1-Se;break}if(M=ut.index+1,B=P.charCodeAt(ut.index),!B){l.textNode+=P.substring(Se,M-1),l.position+=M-1-Se;break}}l.slashed=Fe,l.unicodeI=Ge;continue;case w.TRUE:B===T.r?l.state=w.TRUE2:he(l,"Invalid true started with t"+B);continue;case w.TRUE2:B===T.u?l.state=w.TRUE3:he(l,"Invalid true started with tr"+B);continue;case w.TRUE3:B===T.e?(Ue(l,"onvalue",!0),l.state=l.stack.pop()||w.VALUE):he(l,"Invalid true started with tru"+B);continue;case w.FALSE:B===T.a?l.state=w.FALSE2:he(l,"Invalid false started with f"+B);continue;case w.FALSE2:B===T.l?l.state=w.FALSE3:he(l,"Invalid false started with fa"+B);continue;case w.FALSE3:B===T.s?l.state=w.FALSE4:he(l,"Invalid false started with fal"+B);continue;case w.FALSE4:B===T.e?(Ue(l,"onvalue",!1),l.state=l.stack.pop()||w.VALUE):he(l,"Invalid false started with fals"+B);continue;case w.NULL:B===T.u?l.state=w.NULL2:he(l,"Invalid null started with n"+B);continue;case w.NULL2:B===T.l?l.state=w.NULL3:he(l,"Invalid null started with nu"+B);continue;case w.NULL3:B===T.l?(Ue(l,"onvalue",null),l.state=l.stack.pop()||w.VALUE):he(l,"Invalid null started with nul"+B);continue;case w.NUMBER_DECIMAL_POINT:B===T.period?(l.numberNode+=".",l.state=w.NUMBER_DIGIT):he(l,"Leading zero not followed by .");continue;case w.NUMBER_DIGIT:T._0<=B&&B<=T._9?l.numberNode+=String.fromCharCode(B):B===T.period?(l.numberNode.indexOf(".")!==-1&&he(l,"Invalid number has two dots"),l.numberNode+="."):B===T.e||B===T.E?((l.numberNode.indexOf("e")!==-1||l.numberNode.indexOf("E")!==-1)&&he(l,"Invalid number has two exponential"),l.numberNode+="e"):B===T.plus||B===T.minus?(Oe===T.e||Oe===T.E||he(l,"Invalid symbol in number"),l.numberNode+=String.fromCharCode(B)):(oe(l),M--,l.state=l.stack.pop()||w.VALUE);continue;default:he(l,"Unknown state: "+l.state)}return l.position>=l.bufferCheckPosition&&re(l),l}})(V)});function Ri(q){var V=0,N=Di(),j={pullAsync:function(Y){return nn(this,void 0,void 0,function(){var C,w,H;return Yt(this,function(se){switch(se.label){case 0:return C=q.slice(V,V+Y),V+=Y,[4,Hr(C,"text")];case 1:return w=se.sent(),H=N.write(w),j.result=H||{},[2,H]}})})},pullSync:function(Y){var C=q.slice(V,V+Y);V+=Y;var w=Qr(C,"text"),H=N.write(w);return j.result=H||{},H},done:function(){return N.done()},eof:function(){return V>=q.size},result:{}};return j}function Di(q){var V=Ki.parser(),N=0,j,Y=[],C,w,H=!1,se=!1;return V.onopenobject=function(T){var re={};re.incomplete=!0,j||(j=re),C&&(Y.push([w,C,se]),se?C.push(re):C[w]=re),C=re,w=T,se=!1,++N},V.onkey=function(T){return w=T},V.onvalue=function(T){return se?C.push(T):C[w]=T},V.oncloseobject=function(){var T;delete C.incomplete,w=null,--N===0?H=!0:(T=Y.pop(),w=T[0],C=T[1],se=T[2])},V.onopenarray=function(){var T=[];T.incomplete=!0,j||(j=T),C&&(Y.push([w,C,se]),se?C.push(T):C[w]=T),C=T,se=!0,w=null,++N},V.onclosearray=function(){var T;delete C.incomplete,w=null,--N===0?H=!0:(T=Y.pop(),w=T[0],C=T[1],se=T[2])},{write:function(T){return V.write(T),j},done:function(){return H}}}var ei=1024;function Fi(q,V){return nn(this,void 0,void 0,function(){var N,j,Y,C;return Yt(this,function(w){switch(w.label){case 0:return V=V||{},N=V.chunkSizeBytes||ei*1024,[4,ni(q,N)];case 1:return j=w.sent(),Y=j.result.data,C=new At(Y.databaseName),C.version(Y.databaseVersion).stores(Ti(Y)),[4,ti(C,j,V)];case 2:return w.sent(),[2,C]}})})}function ti(q,V,N){return nn(this,void 0,void 0,function(){function j(){return nn(this,void 0,void 0,function(){var be,Ue,mt,Ze,oe;return Yt(this,function(ct){switch(ct.label){case 0:be=function(he){var Ae,ge,bt,P,l,M,B,Oe,Se,Fe,Ge,ut,st;return Yt(this,function(at){switch(at.label){case 0:if(T.includes(he.tableName))return[2,"continue"];if(!he.rows)return[2,"break"];if(!he.rows.incomplete&&he.rows.length===0)return[2,"continue"];if(re&&At.ignoreTransaction(function(){return re(le)}),Ae=he.tableName,ge=q.table(Ae),bt=se.tables.filter(function(je){return je.name===Ae})[0].schema,!ge){if(N.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(he.tableName," is missing in installed database"))}if(!N.acceptChangedPrimaryKey&&bt.split(",")[0]!=ge.schema.primKey.src)throw new Error("Primary key differs for table ".concat(he.tableName,". "));for(P=he.rows,l=[],M=0;M<P.length&&(B=P[M],!B.incomplete);M++)l.push(Vt.revive(B));return Oe=N.filter,Se=N.transform,Fe=Oe?he.inbound?l.filter(function(je){return Oe(Ae,je)}):l.filter(function(je){var Qe=je[0],Tt=je[1];return Oe(Ae,Tt,Qe)}):l,Se&&(Fe=Fe.map(he.inbound?function(je){return Se(Ae,je).value}:function(je){var Qe=je[0],Tt=je[1],gt=Se(Ae,Tt,Qe);return[gt.key,gt.value]})),Ge=he.inbound?[void 0,Fe]:[Fe.map(function(je){return je[0]}),l.map(function(je){return je[1]})],ut=Ge[0],st=Ge[1],N.overwriteValues?[4,ge.bulkPut(st,ut)]:[3,2];case 1:return at.sent(),[3,4];case 2:return[4,ge.bulkAdd(st,ut)];case 3:at.sent(),at.label=4;case 4:return le.completedRows+=l.length,l.incomplete||(le.completedTables+=1),P.splice(0,l.length),[2]}})},Ue=0,mt=se.data,ct.label=1;case 1:return Ue<mt.length?(Ze=mt[Ue],[5,be(Ze)]):[3,4];case 2:if(oe=ct.sent(),oe==="break")return[3,4];ct.label=3;case 3:return Ue++,[3,1];case 4:for(;se.data.length>0&&se.data[0].rows&&!se.data[0].rows.incomplete;)se.data.splice(0,1);return!C.done()&&!C.eof()?H?(C.pullSync(Y),[3,7]):[3,5]:[3,8];case 5:return[4,At.waitFor(C.pullAsync(Y))];case 6:ct.sent(),ct.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}})})}var Y,C,w,H,se,T,re,le,Ye,ot,ve;return Yt(this,function(be){switch(be.label){case 0:return N=N||{},Y=N.chunkSizeBytes||ei*1024,[4,ni(V,Y)];case 1:if(C=be.sent(),w=C.result,H="FileReaderSync"in self,se=w.data,T=N.skipTables?N.skipTables:[],!N.acceptNameDiff&&q.name!==se.databaseName)throw new Error("Name differs. Current database name is ".concat(q.name," but export is ").concat(se.databaseName));if(!N.acceptVersionDiff&&q.verno!==se.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(q.verno," but export is ").concat(se.databaseVersion));if(re=N.progressCallback,le={done:!1,completedRows:0,completedTables:0,totalRows:se.tables.reduce(function(Ue,mt){return Ue+mt.rowCount},0),totalTables:se.tables.length},re&&At.ignoreTransaction(function(){return re(le)}),!N.clearTablesBeforeImport)return[3,5];Ye=0,ot=q.tables,be.label=2;case 2:return Ye<ot.length?(ve=ot[Ye],T.includes(ve.name)?[3,4]:[4,ve.clear()]):[3,5];case 3:be.sent(),be.label=4;case 4:return Ye++,[3,2];case 5:return N.noTransaction?[4,j()]:[3,7];case 6:return be.sent(),[3,9];case 7:return[4,q.transaction("rw",q.tables,j)];case 8:be.sent(),be.label=9;case 9:return le.done=!0,re&&At.ignoreTransaction(function(){return re(le)}),[2]}})})}function ni(q,V){return nn(this,void 0,void 0,function(){var N,j;return Yt(this,function(Y){switch(Y.label){case 0:N="slice"in q?Ri(q):q,Y.label=1;case 1:return N.eof()?[3,3]:[4,N.pullAsync(V)];case 2:return Y.sent(),N.result.data&&N.result.data.data?[3,3]:[3,1];case 3:if(j=N.result,!j||j.formatName!="dexie")throw new Error("Given file is not a dexie export");if(j.formatVersion>Ii)throw new Error("Format version ".concat(j.formatVersion," not supported"));if(!j.data)throw new Error("No data in export file");if(!j.data.databaseName)throw new Error("Missing databaseName in export file");if(!j.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!j.data.tables)throw new Error("Missing tables in export file");return[2,N]}})})}At.prototype.export=function(q){return Ci(this,q)};At.prototype.import=function(q,V){return ti(this,q,V)};At.import=function(q,V){return Fi(q,V)};export{At as D,Yr as c,Si as g,Li as l};
